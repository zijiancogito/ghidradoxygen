<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>decompile: F:/re/ghidra_sourcecode/ghidra/Ghidra/Features/Decompiler/src/decompile/cpp/heritage.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">decompile
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4d2dc98e227541a044ee6b67b5d94912.html">decompile</a></li><li class="navelem"><a class="el" href="dir_55276c5a5d4e3061aa19bfeed56bd607.html">cpp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">heritage.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="heritage_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* ###</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * IP: GHIDRA</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * You may obtain a copy of the License at</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * limitations under the License.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="heritage_8hh.html">heritage.hh</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="funcdata_8hh.html">funcdata.hh</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="prefersplit_8hh.html">prefersplit.hh</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="class_location_map.html#a72014909f852e240636856c3fec0ca04">   30</a></span>&#160;<a class="code" href="class_location_map.html#a13612b4d0583b85205f3ad6476c2aef9">LocationMap::iterator</a> <a class="code" href="class_location_map.html#a72014909f852e240636856c3fec0ca04">LocationMap::add</a>(Address addr,int4 size,int4 pass,int4 &amp;intersect)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="class_location_map.html#a13612b4d0583b85205f3ad6476c2aef9">iterator</a> iter = themap.lower_bound(addr);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordflow">if</span> (iter != themap.begin())</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    --iter;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span> ((iter!=themap.end())&amp;&amp;(-1 == addr.overlap(0,(*iter).first,(*iter).second.size)))</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    ++iter;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  int4 where=0;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  intersect = 0;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">if</span> ((iter!=themap.end())&amp;&amp;(-1!=(where=addr.overlap(0,(*iter).first,(*iter).second.size)))) {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (where+size&lt;=(*iter).second.size) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      intersect = ((*iter).second.pass &lt; pass) ? 2 : 0; <span class="comment">// Completely contained in previous element</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">return</span> iter;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    addr = (*iter).first;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    size = where+size;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> ((*iter).second.pass &lt; pass)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      intersect = 1;            <span class="comment">// Partial overlap with old element</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    themap.erase(iter++);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">while</span>((iter!=themap.end())&amp;&amp;(-1!=(where=(*iter).first.overlap(0,addr,size)))) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span> (where+(*iter).second.size&gt;size)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      size = where+(*iter).second.size;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> ((*iter).second.pass &lt; pass)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      intersect = 1;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    themap.erase(iter++);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  iter = themap.insert(pair&lt;Address,SizePass&gt;( addr, <a class="code" href="struct_size_pass.html">SizePass</a>() )).first;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  (*iter).second.size = size;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  (*iter).second.pass = pass;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">return</span> iter;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="class_location_map.html#a46317268798a00ecc792e87a4a360bef">   69</a></span>&#160;<a class="code" href="class_location_map.html#a13612b4d0583b85205f3ad6476c2aef9">LocationMap::iterator</a> <a class="code" href="class_location_map.html#a46317268798a00ecc792e87a4a360bef">LocationMap::find</a>(Address addr)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="class_location_map.html#a13612b4d0583b85205f3ad6476c2aef9">iterator</a> iter = themap.upper_bound(addr); <span class="comment">// First range after address</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">if</span> (iter == themap.begin()) <span class="keywordflow">return</span> themap.end();</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  --iter;           <span class="comment">// First range before or equal to address</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">if</span> (-1!=addr.overlap(0,(*iter).first,(*iter).second.size))</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">return</span> iter;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">return</span> themap.end();</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="class_location_map.html#aa4e4c0f548533f8607a706cf7796c789">   83</a></span>&#160;int4 <a class="code" href="class_location_map.html#aa4e4c0f548533f8607a706cf7796c789">LocationMap::findPass</a>(Address addr)<span class="keyword"> const</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword"></span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  map&lt;Address,SizePass&gt;::const_iterator iter = themap.upper_bound(addr); <span class="comment">// First range after address</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">if</span> (iter == themap.begin()) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  --iter;           <span class="comment">// First range before or equal to address</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (-1!=addr.overlap(0,(*iter).first,(*iter).second.size))</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">return</span> (*iter).second.pass;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="class_priority_queue.html#a75ec253ec066ea6dc172f1f8bd88758b">   97</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_priority_queue.html#a75ec253ec066ea6dc172f1f8bd88758b">PriorityQueue::reset</a>(int4 maxdepth) </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">if</span> ((curdepth==-1)&amp;&amp;(maxdepth==queue.size()-1)) <span class="keywordflow">return</span>; <span class="comment">// Already reset</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  queue.clear();</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  queue.resize(maxdepth+1);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  curdepth = -1;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="class_priority_queue.html#a8abe49ecb70033726324497f4aafdb74">  109</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_priority_queue.html#a8abe49ecb70033726324497f4aafdb74">PriorityQueue::insert</a>(<a class="code" href="class_flow_block.html">FlowBlock</a> *bl,int4 depth)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  queue[depth].push_back(bl);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span> (depth &gt; curdepth)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    curdepth = depth;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="class_priority_queue.html#a6cd7194cc2cb973f33158a1d7dc7acc9">  121</a></span>&#160;<a class="code" href="class_flow_block.html">FlowBlock</a> *<a class="code" href="class_priority_queue.html#a6cd7194cc2cb973f33158a1d7dc7acc9">PriorityQueue::extract</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="class_flow_block.html">FlowBlock</a> *res = queue[curdepth].back();</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  queue[curdepth].pop_back();</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">while</span>(queue[curdepth].<a class="code" href="class_priority_queue.html#aa52c8c07deead26f255cdbe92a0acd4e">empty</a>()) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    curdepth -= 1;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">if</span> (curdepth &lt;0) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="class_heritage.html#a9241f6a476085c88c540e34a44c5f197">  135</a></span>&#160;<a class="code" href="class_heritage.html#a9241f6a476085c88c540e34a44c5f197">Heritage::Heritage</a>(<a class="code" href="class_funcdata.html">Funcdata</a> *data)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  fd = data;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  pass = 0;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  maxdepth = -1;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keywordtype">void</span> Heritage::clearInfoList(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  vector&lt;HeritageInfo&gt;::iterator iter;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">for</span>(iter=infolist.begin();iter!=infolist.end();++iter) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    (*iter).deadremoved = 0;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    (*iter).deadcodedelay = (*iter).delay;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    (*iter).warningissued = <span class="keyword">false</span>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;int4 Heritage::collect(Address addr,int4 size,</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;              vector&lt;Varnode *&gt; &amp;read,vector&lt;Varnode *&gt; &amp;write,</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;              vector&lt;Varnode *&gt; &amp;input)<span class="keyword"> const</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keyword"></span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  Varnode *vn;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  VarnodeLocSet::const_iterator viter = fd-&gt;<a class="code" href="class_funcdata.html#ac34a257742ad827bd278d0b35e15af74">beginLoc</a>(addr);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  VarnodeLocSet::const_iterator enditer;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="types_8h.html#a2db313c5d32a12b01d26ac9b3bca178f">uintb</a> start = addr.getOffset();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  addr = addr + size;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">if</span> (addr.getOffset() &lt; start) {   <span class="comment">// Wraparound</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    Address tmp(addr.getSpace(),addr.getSpace()-&gt;getHighest());</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    enditer = fd-&gt;<a class="code" href="class_funcdata.html#a49f4e57094c47d431d81545f28172c1f">endLoc</a>(tmp);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    enditer = fd-&gt;<a class="code" href="class_funcdata.html#ac34a257742ad827bd278d0b35e15af74">beginLoc</a>(addr);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  int4 maxsize = 0;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">while</span>( viter != enditer ) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    vn = *viter;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (!vn-&gt;isWriteMask()) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (vn-&gt;isWritten()) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span> (vn-&gt;getSize() &gt; maxsize) <span class="comment">// Look for maximum write size</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      maxsize = vn-&gt;getSize();</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    write.push_back(vn);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!vn-&gt;isHeritageKnown())&amp;&amp;(!vn-&gt;hasNoDescend()))</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    read.push_back(vn);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vn-&gt;isInput())</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    input.push_back(vn);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    ++viter;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">return</span> maxsize;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordtype">bool</span> Heritage::callOpIndirectEffect(<span class="keyword">const</span> Address &amp;addr,int4 size,PcodeOp *op)<span class="keyword"> const</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keyword"></span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span> ((op-&gt;code() == <a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a50235a7bf50bada36dff73ff740c34d0">CPUI_CALL</a>)||(op-&gt;code() == <a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a500b63ecb17a75652c705bfab98bc8e5">CPUI_CALLIND</a>)) {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// We should be able to get the callspec</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="class_func_call_specs.html">FuncCallSpecs</a> *fc = fd-&gt;<a class="code" href="class_funcdata.html#a8bc1d922d37c04236c4f7db44930b4fc">getCallSpecs</a>(op);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (fc == (<a class="code" href="class_func_call_specs.html">FuncCallSpecs</a> *)0) <span class="keywordflow">return</span> <span class="keyword">true</span>;      <span class="comment">// Assume indirect effect</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span> (fc-&gt;<a class="code" href="class_func_call_specs.html#a37a11cd8c631ed5b643eaf259b2ae49b">hasEffectTranslate</a>(addr,size) != <a class="code" href="class_effect_record.html#a9a77875d39274819c56d6e4df5f23ab0a3488da6d6b149499cbe384f7b57d0564">EffectRecord::unaffected</a>);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// If we reach here, this is a CALLOTHER, NEW</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// We assume these do not have effects on -fd- variables except for op-&gt;getOut().</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;Varnode *Heritage::normalizeReadSize(Varnode *vn,<span class="keyword">const</span> Address &amp;addr,int4 size)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  int4 overlap;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  Varnode *vn1,*vn2;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  PcodeOp *op,*newop;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  list&lt;PcodeOp *&gt;::const_iterator oiter = vn-&gt;beginDescend();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  op = *oiter++;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">if</span> (oiter != vn-&gt;endDescend())</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Free varnode with multiple reads&quot;</span>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  newop = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,op-&gt;getAddr());</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(newop,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  vn1 = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(size,addr);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  overlap = vn-&gt;overlap(addr,size);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  vn2 = fd-&gt;<a class="code" href="class_funcdata.html#af58542dbcc89f4b84ffc8834b023125b">newConstant</a>(addr.getAddrSize(),(<a class="code" href="types_8h.html#a2db313c5d32a12b01d26ac9b3bca178f">uintb</a>)overlap);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,vn1,0);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,vn2,1);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#ab2bd3523c574c5b303728ef4d880ec3a">opSetOutput</a>(newop,vn);    <span class="comment">// Old vn is no longer a free read</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  newop-&gt;getOut()-&gt;setWriteMask();</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#a9dd86e17a47020d06ac8dfd3bb732fe5">opInsertBefore</a>(newop,op);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">return</span> vn1;           <span class="comment">// But we have new free read of uniform size</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;Varnode *Heritage::normalizeWriteSize(Varnode *vn,<span class="keyword">const</span> Address &amp;addr,int4 size)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;{</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  int4 overlap;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  int4 mostsigsize;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  PcodeOp *op,*newop;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  Varnode *mostvn,*leastvn,*big,*bigout,*midvn;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  mostvn = (Varnode *)0;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  op = vn-&gt;getDef();</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  overlap = vn-&gt;overlap(addr,size);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  mostsigsize = size-(overlap+vn-&gt;getSize());</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordflow">if</span> (mostsigsize != 0) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    Address pieceaddr;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span> (addr.isBigEndian())</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      pieceaddr = addr;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      pieceaddr = addr + (overlap+vn-&gt;getSize());</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> (op-&gt;isCall() &amp;&amp; callOpIndirectEffect(pieceaddr,mostsigsize,op)) {   <span class="comment">// Unless CALL definitely has no effect on piece</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      newop = fd-&gt;<a class="code" href="class_funcdata.html#add1098b768d9a176cf59e4f4c9e27cb5">newIndirectCreation</a>(op,pieceaddr,mostsigsize,<span class="keyword">false</span>);      <span class="comment">// Don&#39;t create a new big read if write is from a CALL</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      mostvn = newop-&gt;getOut();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      newop = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,op-&gt;getAddr());</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      mostvn = fd-&gt;<a class="code" href="class_funcdata.html#a100e6704e4c245e076170268d31b47ec">newVarnodeOut</a>(mostsigsize,pieceaddr,newop);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      big = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(size,addr);  <span class="comment">// The new read</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      big-&gt;setActiveHeritage();</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(newop,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,big,0);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,fd-&gt;<a class="code" href="class_funcdata.html#af58542dbcc89f4b84ffc8834b023125b">newConstant</a>(addr.getAddrSize(),(<a class="code" href="types_8h.html#a2db313c5d32a12b01d26ac9b3bca178f">uintb</a>)overlap+vn-&gt;getSize()),1);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#a9dd86e17a47020d06ac8dfd3bb732fe5">opInsertBefore</a>(newop,op);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">if</span> (overlap != 0) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    Address pieceaddr;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">if</span> (addr.isBigEndian())</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      pieceaddr = addr + (size-overlap);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      pieceaddr = addr;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> (op-&gt;isCall() &amp;&amp; callOpIndirectEffect(pieceaddr,overlap,op)) {       <span class="comment">// Unless CALL definitely has no effect on piece</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      newop = fd-&gt;<a class="code" href="class_funcdata.html#add1098b768d9a176cf59e4f4c9e27cb5">newIndirectCreation</a>(op,pieceaddr,overlap,<span class="keyword">false</span>);      <span class="comment">// Don&#39;t create a new big read if write is from a CALL</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      leastvn = newop-&gt;getOut();</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      newop = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,op-&gt;getAddr());</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      leastvn = fd-&gt;<a class="code" href="class_funcdata.html#a100e6704e4c245e076170268d31b47ec">newVarnodeOut</a>(overlap,pieceaddr,newop);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      big = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(size,addr);  <span class="comment">// The new read</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      big-&gt;setActiveHeritage();</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(newop,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a>);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,big,0);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,fd-&gt;<a class="code" href="class_funcdata.html#af58542dbcc89f4b84ffc8834b023125b">newConstant</a>(addr.getAddrSize(),0),1);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#a9dd86e17a47020d06ac8dfd3bb732fe5">opInsertBefore</a>(newop,op);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">if</span> (overlap !=0 ) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    newop = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,op-&gt;getAddr());</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (addr.isBigEndian())</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      midvn = fd-&gt;<a class="code" href="class_funcdata.html#a100e6704e4c245e076170268d31b47ec">newVarnodeOut</a>(overlap+vn-&gt;getSize(),vn-&gt;getAddr(),newop);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      midvn = fd-&gt;<a class="code" href="class_funcdata.html#a100e6704e4c245e076170268d31b47ec">newVarnodeOut</a>(overlap+vn-&gt;getSize(),addr,newop);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(newop,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a69a387d1e0b510d027e69bdde8f03caa">CPUI_PIECE</a>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,vn,0); <span class="comment">// Most significant part</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,leastvn,1); <span class="comment">// Least sig</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#a3320ad92e11a48a06e21b8a55395a56b">opInsertAfter</a>(newop,op);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    midvn = vn;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">if</span> (mostsigsize != 0) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    newop = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,op-&gt;getAddr());</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    bigout = fd-&gt;<a class="code" href="class_funcdata.html#a100e6704e4c245e076170268d31b47ec">newVarnodeOut</a>(size,addr,newop);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(newop,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a69a387d1e0b510d027e69bdde8f03caa">CPUI_PIECE</a>);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,mostvn,0);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,midvn,1);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#a3320ad92e11a48a06e21b8a55395a56b">opInsertAfter</a>(newop,midvn-&gt;getDef());</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    bigout = midvn;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  vn-&gt;setWriteMask();</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">return</span> bigout;        <span class="comment">// Replace small write with big write</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;Varnode *Heritage::concatPieces(<span class="keyword">const</span> vector&lt;Varnode *&gt; &amp;vnlist,PcodeOp *insertop,Varnode *finalvn)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  Varnode *preexist = vnlist[0];</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordtype">bool</span> isbigendian = preexist-&gt;getAddr().isBigEndian();</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  Address opaddress;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <a class="code" href="class_block_basic.html">BlockBasic</a> *bl;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  list&lt;PcodeOp *&gt;::iterator insertiter;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">if</span> (insertop == (PcodeOp *)0) { <span class="comment">// Insert at the beginning</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    bl = (<a class="code" href="class_block_basic.html">BlockBasic</a> *)fd-&gt;<a class="code" href="class_funcdata.html#add21153afa5eb571406d1f64b8b344db">getBasicBlocks</a>().<a class="code" href="class_block_graph.html#ae4f8f8599ed5e3eb803536f1c9595f09">getStartBlock</a>();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    insertiter = bl-&gt;<a class="code" href="class_block_basic.html#a3ddd779a5af8cb12e6fc069bd49ddb6c">beginOp</a>();</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    opaddress = fd-&gt;<a class="code" href="class_funcdata.html#ae3357db0b73196679a798903f28cd798">getAddress</a>();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    bl = insertop-&gt;<a class="code" href="class_flow_block.html#aa09d7d958c190fa86a30dbe9ac23c78f">getParent</a>();</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    insertiter = insertop-&gt;getBasicIter();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    opaddress = insertop-&gt;getAddr();</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">for</span>(uint4 i=1;i&lt;vnlist.size();++i) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    Varnode *vn = vnlist[i];</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    PcodeOp *newop = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,opaddress);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(newop,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a69a387d1e0b510d027e69bdde8f03caa">CPUI_PIECE</a>);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    Varnode *newvn;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (i==vnlist.size()-1) {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      newvn = finalvn;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ab2bd3523c574c5b303728ef4d880ec3a">opSetOutput</a>(newop,newvn);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      newvn = fd-&gt;<a class="code" href="class_funcdata.html#af189a9a5b390332c6e87c8faa334cd68">newUniqueOut</a>(preexist-&gt;getSize()+vn-&gt;getSize(),newop);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span> (isbigendian) {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,preexist,0); <span class="comment">// Most sig part</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,vn,1); <span class="comment">// Least sig part</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,vn,0);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,preexist,1);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#a6b77ee6442d79ae754d5dcf0b5318fca">opInsert</a>(newop,bl,insertiter);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    preexist = newvn;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">return</span> preexist;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordtype">void</span> Heritage::splitPieces(<span class="keyword">const</span> vector&lt;Varnode *&gt; &amp;vnlist,PcodeOp *insertop,</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;               <span class="keyword">const</span> Address &amp;addr,int4 size,Varnode *startvn)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;{</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  Address opaddress;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <a class="code" href="types_8h.html#a2db313c5d32a12b01d26ac9b3bca178f">uintb</a> baseoff;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordtype">bool</span> isbigendian;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <a class="code" href="class_block_basic.html">BlockBasic</a> *bl;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  list&lt;PcodeOp *&gt;::iterator insertiter;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  isbigendian = addr.isBigEndian();</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">if</span> (isbigendian)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    baseoff = addr.getOffset() + size;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    baseoff = addr.getOffset();</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">if</span> (insertop == (PcodeOp *)0) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    bl = (<a class="code" href="class_block_basic.html">BlockBasic</a> *)fd-&gt;<a class="code" href="class_funcdata.html#add21153afa5eb571406d1f64b8b344db">getBasicBlocks</a>().<a class="code" href="class_block_graph.html#ae4f8f8599ed5e3eb803536f1c9595f09">getStartBlock</a>();</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    insertiter = bl-&gt;<a class="code" href="class_block_basic.html#a3ddd779a5af8cb12e6fc069bd49ddb6c">beginOp</a>();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    opaddress = fd-&gt;<a class="code" href="class_funcdata.html#ae3357db0b73196679a798903f28cd798">getAddress</a>();</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    bl = insertop-&gt;<a class="code" href="class_flow_block.html#aa09d7d958c190fa86a30dbe9ac23c78f">getParent</a>();</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    insertiter = insertop-&gt;getBasicIter();</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    ++insertiter;       <span class="comment">// Insert AFTER the write</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    opaddress = insertop-&gt;getAddr();</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">for</span>(uint4 i=0;i&lt;vnlist.size();++i) {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    Varnode *vn = vnlist[i];</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    PcodeOp *newop = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,opaddress);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(newop,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="types_8h.html#a2db313c5d32a12b01d26ac9b3bca178f">uintb</a> diff;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">if</span> (isbigendian)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      diff = baseoff - (vn-&gt;getOffset() + vn-&gt;getSize());</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      diff = vn-&gt;getOffset() - baseoff;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,startvn,0);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(newop,fd-&gt;<a class="code" href="class_funcdata.html#af58542dbcc89f4b84ffc8834b023125b">newConstant</a>(4,diff),1);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#ab2bd3523c574c5b303728ef4d880ec3a">opSetOutput</a>(newop,vn);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#a6b77ee6442d79ae754d5dcf0b5318fca">opInsert</a>(newop,bl,insertiter);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;}</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordtype">void</span> Heritage::guard(<span class="keyword">const</span> Address &amp;addr,int4 size,vector&lt;Varnode *&gt; &amp;read,vector&lt;Varnode *&gt; &amp;write,</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;             vector&lt;Varnode *&gt; &amp;inputvars)</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;{</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  uint4 flags;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  Varnode *vn;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  vector&lt;Varnode *&gt;::iterator iter;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordtype">bool</span> guardneeded = <span class="keyword">true</span>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">for</span>(iter=read.begin();iter!=read.end();++iter) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    vn = *iter;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span> (vn-&gt;getSize() &lt; size)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      *iter = vn = normalizeReadSize(vn,addr,size);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    vn-&gt;setActiveHeritage();</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">for</span>(iter=write.begin();iter!=write.end();++iter) {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    vn = *iter;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> (vn-&gt;getSize() &lt; size)</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      *iter = vn = normalizeWriteSize(vn,addr,size);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    vn-&gt;setActiveHeritage();</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span> (vn-&gt;isAddrForce())</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      guardneeded = <span class="keyword">false</span>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordflow">if</span> (vn-&gt;isWritten()) {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span> (vn-&gt;getDef()-&gt;code() == <a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aa89e33b07a26ca7d26b54315e45c8424">CPUI_INDIRECT</a>) <span class="comment">// Evidence of a previous guard</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      guardneeded = <span class="keyword">false</span>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">if</span> (read.empty() &amp;&amp; write.empty() &amp;&amp; inputvars.empty()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <span class="comment">// This may need to be adjusted in the future</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <span class="comment">// Basically we need to take into account the possibility</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="comment">// that the full syntax tree may form over several stages</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <span class="comment">// so there is the possibility that we will see a new</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <span class="comment">// free for an address that has already been guarded before</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <span class="comment">// Because INDIRECTs for a single call or store really</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <span class="comment">// issue simultaneously, having multiple INDIRECT guards</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <span class="comment">// for the same address confuses the renaming algorithm</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <span class="comment">// SO we don&#39;t guard if we think we&#39;ve guarded before</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">if</span> (guardneeded) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    flags = 0;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// Query for generic properties of address (use empty usepoint)</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aaa28789a086c52edd04c41e265818bbb">getScopeLocal</a>()-&gt;<a class="code" href="class_scope.html#a1b8c2c2302eba2666e319a4c18a67d51">queryProperties</a>(addr,size,Address(),flags);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    guardCalls(flags,addr,size,write);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    guardReturns(flags,addr,size,write);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">if</span> (fd-&gt;<a class="code" href="class_funcdata.html#a47b9d753da3c1caf025981ced51c1e96">getArch</a>()-&gt;<a class="code" href="class_architecture.html#a9ec2e6c18d4b1280dc955ec0ace7d476">highPtrPossible</a>(addr,size)) {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      guardStores(addr,size,write);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="comment">//      guardLoads(flags,addr,size,write);</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="keywordtype">void</span> Heritage::guardCalls(uint4 flags,<span class="keyword">const</span> Address &amp;addr,int4 size,vector&lt;Varnode *&gt; &amp;write)</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;{</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <a class="code" href="class_func_call_specs.html">FuncCallSpecs</a> *fc;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  PcodeOp *indop;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  uint4 effecttype;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordtype">bool</span> holdind = ((flags&amp;<a class="code" href="class_varnode.html#ad367c0ac3c08b6f41e7334e90a138e8ca7d4bde53093050741edab33ff1b80b0a">Varnode::addrtied</a>)!=0);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordflow">for</span>(int4 i=0;i&lt;fd-&gt;<a class="code" href="class_funcdata.html#a0901453d881b28305cb071a3cc8a7fe9">numCalls</a>();++i) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    fc = fd-&gt;<a class="code" href="class_funcdata.html#a8bc1d922d37c04236c4f7db44930b4fc">getCallSpecs</a>(i);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">if</span> (fc-&gt;<a class="code" href="class_func_call_specs.html#ad88ee3058ece9a8b19f4e25566c03121">getOp</a>()-&gt;isAssignment()) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      Varnode *vn = fc-&gt;<a class="code" href="class_func_call_specs.html#ad88ee3058ece9a8b19f4e25566c03121">getOp</a>()-&gt;getOut();</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">if</span> ((vn-&gt;getAddr()==addr)&amp;&amp;(vn-&gt;getSize()==size)) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    effecttype = fc-&gt;<a class="code" href="class_func_call_specs.html#a37a11cd8c631ed5b643eaf259b2ae49b">hasEffectTranslate</a>(addr,size);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordtype">bool</span> possibleoutput = <span class="keyword">false</span>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span> (fc-&gt;<a class="code" href="class_func_call_specs.html#a81e8386ebb901a273ef40d8e8430fb57">isOutputActive</a>()) {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="class_param_active.html">ParamActive</a> *active = fc-&gt;<a class="code" href="class_func_call_specs.html#a866e9a9406614829224612035f28d311">getActiveOutput</a>();</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">if</span> (fc-&gt;<a class="code" href="class_func_proto.html#a65c37f6adddd70f3fd17500dcacd0c92">possibleOutputParam</a>(addr,size)) {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span> (active-&gt;<a class="code" href="class_param_active.html#a94904915a57b3a27a68053e85d6d08e1">whichTrial</a>(addr,size)&lt;0) { <span class="comment">// If not already a trial</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      active-&gt;<a class="code" href="class_param_active.html#a43a357162f55b3b8f7e13a013ad207b5">registerTrial</a>(addr,size);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      effecttype = <a class="code" href="class_effect_record.html#a9a77875d39274819c56d6e4df5f23ab0aacd8991c4ebdeb4057e15faf1d08abc2">EffectRecord::killedbycall</a>; <span class="comment">// A potential output is always killed by call</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      possibleoutput = <span class="keyword">true</span>;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">if</span> (fc-&gt;<a class="code" href="class_func_call_specs.html#a4145c5e63b80ece45a2a4f0fd5949138">isInputActive</a>()) {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <a class="code" href="class_addr_space.html">AddrSpace</a> *spc = addr.getSpace();</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <a class="code" href="types_8h.html#a2db313c5d32a12b01d26ac9b3bca178f">uintb</a> off = addr.getOffset();</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordtype">bool</span> tryregister = <span class="keyword">true</span>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordflow">if</span> (spc-&gt;<a class="code" href="class_addr_space.html#ab548f4158529a29122d4d0a30d94ed98">getType</a>() == <a class="code" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231aebea73c9a75ffad2803a312d021932b5">IPTR_SPACEBASE</a>) {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span> (fc-&gt;<a class="code" href="class_func_call_specs.html#abfda84c2a3919927503193ce9595efd6">getStackPlaceholderSlot</a>() &lt; 0) { <span class="comment">// Any stack resolution is complete (or never started)</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordflow">if</span> (fc-&gt;<a class="code" href="class_func_call_specs.html#ad8990f080a96809b347656d7331236c5">getSpacebaseOffset</a>() != <a class="code" href="class_func_call_specs.html#a5f7aaec10dc1e68d73a07eaf4cac2542a584ec7401809588c22798803bff5b796">FuncCallSpecs::offset_unknown</a>)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        off = spc-&gt;<a class="code" href="class_addr_space.html#aaf923ed847e9804b55ffa12a51202712">wrapOffset</a>(off - fc-&gt;<a class="code" href="class_func_call_specs.html#ad8990f080a96809b347656d7331236c5">getSpacebaseOffset</a>());</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        tryregister = <span class="keyword">false</span>; <span class="comment">// Do not attempt to register this stack loc as a trial</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">else</span> {          <span class="comment">// Stack has not been resolved, so we need to abort</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      fc-&gt;<a class="code" href="class_func_call_specs.html#ad3c3231b5c523e491d65f31ddb688cc1">abortSpacebaseRelative</a>(*fd);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      tryregister = <span class="keyword">false</span>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      Address taddr(spc,off);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">if</span> (tryregister &amp;&amp; fc-&gt;<a class="code" href="class_func_proto.html#a59ed6ca81a4b601ae81f4080a5bf89fa">possibleInputParam</a>(taddr,size)) {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="class_param_active.html">ParamActive</a> *active = fc-&gt;<a class="code" href="class_func_call_specs.html#a32432a6c7b201dc160ae0b2480a1b8b9">getActiveInput</a>();</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">if</span> (active-&gt;<a class="code" href="class_param_active.html#a94904915a57b3a27a68053e85d6d08e1">whichTrial</a>(taddr,size)&lt;0) { <span class="comment">// If not already a trial</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      PcodeOp *op = fc-&gt;<a class="code" href="class_func_call_specs.html#ad88ee3058ece9a8b19f4e25566c03121">getOp</a>();</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      active-&gt;<a class="code" href="class_param_active.html#a43a357162f55b3b8f7e13a013ad207b5">registerTrial</a>(taddr,size);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      Varnode *vn = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(size,addr);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      vn-&gt;setActiveHeritage();</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ab34e641f5ee6f2ebf4aa708e21f2b24c">opInsertInput</a>(op,vn,op-&gt;numInput());</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// We do not guard the call if the effect is &quot;unaffected&quot; or &quot;reload&quot;</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span> ((effecttype == <a class="code" href="class_effect_record.html#a9a77875d39274819c56d6e4df5f23ab0a02697f294ad0f4b53317da792c577a10">EffectRecord::unknown_effect</a>)||(effecttype == <a class="code" href="class_effect_record.html#a9a77875d39274819c56d6e4df5f23ab0afa04c6c617a1044c79c7bc9b7d661be2">EffectRecord::return_address</a>)) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      indop = fd-&gt;<a class="code" href="class_funcdata.html#ae12a353a87a208c1a39442571990fb9f">newIndirectOp</a>(fc-&gt;<a class="code" href="class_func_call_specs.html#ad88ee3058ece9a8b19f4e25566c03121">getOp</a>(),addr,size);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      indop-&gt;getIn(0)-&gt;setActiveHeritage();</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      indop-&gt;getOut()-&gt;setActiveHeritage();</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      write.push_back(indop-&gt;getOut());</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">if</span> (holdind)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        indop-&gt;getOut()-&gt;setAddrForce();</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">if</span> (effecttype == <a class="code" href="class_effect_record.html#a9a77875d39274819c56d6e4df5f23ab0afa04c6c617a1044c79c7bc9b7d661be2">EffectRecord::return_address</a>)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    indop-&gt;getOut()-&gt;setReturnAddress();</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (effecttype == <a class="code" href="class_effect_record.html#a9a77875d39274819c56d6e4df5f23ab0aacd8991c4ebdeb4057e15faf1d08abc2">EffectRecord::killedbycall</a>) {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      indop = fd-&gt;<a class="code" href="class_funcdata.html#add1098b768d9a176cf59e4f4c9e27cb5">newIndirectCreation</a>(fc-&gt;<a class="code" href="class_func_call_specs.html#ad88ee3058ece9a8b19f4e25566c03121">getOp</a>(),addr,size,possibleoutput);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      indop-&gt;getOut()-&gt;setActiveHeritage();</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      write.push_back(indop-&gt;getOut());</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;}</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keywordtype">void</span> Heritage::guardStores(<span class="keyword">const</span> Address &amp;addr,int4 size,vector&lt;Varnode *&gt; &amp;write)</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  list&lt;PcodeOp *&gt;::const_iterator iter,iterend;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  PcodeOp *op,*indop;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  iterend = fd-&gt;<a class="code" href="class_funcdata.html#ad24461680d41c61349b3717283d8b854">endOp</a>(<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a14ab8d826af51873faa33b33e2bbc5fb">CPUI_STORE</a>);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keywordflow">for</span>(iter=fd-&gt;<a class="code" href="class_funcdata.html#a47de4c82b4a74b356153eb8e4215f639">beginOp</a>(<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a14ab8d826af51873faa33b33e2bbc5fb">CPUI_STORE</a>);iter!=iterend;++iter) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    op = *iter;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordflow">if</span> (op-&gt;isDead()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (addr.getSpace()-&gt;contain(<a class="code" href="class_address.html#acd17db20230415cb1fe1ad33c34c11ff">Address::getSpaceFromConst</a>(op-&gt;getIn(0)-&gt;getAddr()))) { <span class="comment">// Does store affect same space</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      indop = fd-&gt;<a class="code" href="class_funcdata.html#ae12a353a87a208c1a39442571990fb9f">newIndirectOp</a>(op,addr,size);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      indop-&gt;getIn(0)-&gt;setActiveHeritage();</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      indop-&gt;getOut()-&gt;setActiveHeritage();</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      write.push_back(indop-&gt;getOut());</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;}</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keywordtype">void</span> Heritage::guardReturns(uint4 flags,<span class="keyword">const</span> Address &amp;addr,int4 size,vector&lt;Varnode *&gt; &amp;write)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;{</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  list&lt;PcodeOp *&gt;::const_iterator iter,iterend;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  PcodeOp *op,*copyop;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <a class="code" href="class_param_active.html">ParamActive</a> *active = fd-&gt;<a class="code" href="class_funcdata.html#a4a711cda20fb99632665753918c03a65">getActiveOutput</a>();</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">if</span> (active != (<a class="code" href="class_param_active.html">ParamActive</a> *)0) {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">if</span> (fd-&gt;<a class="code" href="class_funcdata.html#a1b1961c6d9c58e9a0a20f74c6e49853f">getFuncProto</a>().<a class="code" href="class_func_proto.html#a65c37f6adddd70f3fd17500dcacd0c92">possibleOutputParam</a>(addr,size)) {</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      active-&gt;<a class="code" href="class_param_active.html#a43a357162f55b3b8f7e13a013ad207b5">registerTrial</a>(addr,size);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      iterend = fd-&gt;<a class="code" href="class_funcdata.html#ad24461680d41c61349b3717283d8b854">endOp</a>(<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7af2f97499d0b08f223110ad8f59353b44">CPUI_RETURN</a>);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordflow">for</span>(iter=fd-&gt;<a class="code" href="class_funcdata.html#a47de4c82b4a74b356153eb8e4215f639">beginOp</a>(<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7af2f97499d0b08f223110ad8f59353b44">CPUI_RETURN</a>);iter!=iterend;++iter) {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    op = *iter;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">if</span> (op-&gt;isDead()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">if</span> (op-&gt;getHaltType() != 0) <span class="keywordflow">continue</span>; <span class="comment">// Special halt points cannot take return values</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    Varnode *invn = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(size,addr);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    invn-&gt;setActiveHeritage();</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#ab34e641f5ee6f2ebf4aa708e21f2b24c">opInsertInput</a>(op,invn,op-&gt;numInput());</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      }</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">if</span> ((flags&amp;<a class="code" href="class_varnode.html#ad367c0ac3c08b6f41e7334e90a138e8ca952005b91ba1b04e4d431eecb1309112">Varnode::persist</a>)==0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  iterend = fd-&gt;<a class="code" href="class_funcdata.html#ad24461680d41c61349b3717283d8b854">endOp</a>(<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7af2f97499d0b08f223110ad8f59353b44">CPUI_RETURN</a>);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">for</span>(iter=fd-&gt;<a class="code" href="class_funcdata.html#a47de4c82b4a74b356153eb8e4215f639">beginOp</a>(<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7af2f97499d0b08f223110ad8f59353b44">CPUI_RETURN</a>);iter!=iterend;++iter) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    op = *iter;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">if</span> (op-&gt;isDead()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    copyop = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(1,op-&gt;getAddr());</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    Varnode *vn = fd-&gt;<a class="code" href="class_funcdata.html#a100e6704e4c245e076170268d31b47ec">newVarnodeOut</a>(size,addr,copyop);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    vn-&gt;setAddrForce();</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    vn-&gt;setActiveHeritage();</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(copyop,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a36a10374a26740a58b5625f340f6ffad">CPUI_COPY</a>);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    Varnode *invn = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(size,addr);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    invn-&gt;setActiveHeritage();</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(copyop,invn,0);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#a9dd86e17a47020d06ac8dfd3bb732fe5">opInsertBefore</a>(copyop,op);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">// void Heritage::guardLoads(uint4 flags,const Address &amp;addr,int4 size,vector&lt;Varnode *&gt; &amp;write)</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">// {</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">//   list&lt;PcodeOp *&gt;::const_iterator iter,iterend;</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">//   PcodeOp *op,*copyop;</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">//   iterend = fd-&gt;endOp(CPUI_LOAD);</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">//   for(iter=fd-&gt;beginOp(CPUI_LOAD);iter!=iterend;++iter) {</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">//     op = *iter;</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">//     if (op-&gt;isDead()) continue;</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">//              // Check if load could possible read from this addr</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">//     if (!Address::getSpaceFromConst(op-&gt;getIn(0)-&gt;getAddr())-&gt;contain(addr.getSpace()))</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">//       continue;</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">//     copyop = fd-&gt;newOp(1,op-&gt;getAddr());</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">//     Varnode *vn = fd-&gt;newVarnodeOut(size,addr,copyop);</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">//     vn-&gt;setActiveHeritage();</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">//     vn-&gt;setAddrForce();</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">//     fd-&gt;opSetOpcode(copyop,CPUI_COPY);</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">//     Varnode *invn = fd-&gt;newVarnode(size,addr);</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">//     vn-&gt;setActiveHeritage();</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">//     fd-&gt;opSetInput(copyop,invn,0);</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">//     fd-&gt;opInsertBefore(copyop,op);</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">//   }</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">// }</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keywordtype">void</span> Heritage::buildRefinement(vector&lt;int4&gt; &amp;refine,<span class="keyword">const</span> Address &amp;addr,int4 size,<span class="keyword">const</span> vector&lt;Varnode *&gt; &amp;vnlist)</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;{</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">for</span>(uint4 i=0;i&lt;vnlist.size();++i) {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    Address curaddr = vnlist[i]-&gt;getAddr();</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    int4 sz = vnlist[i]-&gt;getSize();</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    uint4 diff = (uint4)(curaddr.getOffset() - addr.getOffset());</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    refine[diff] = 1;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    refine[diff+sz] = 1;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;}</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="keywordtype">void</span> Heritage::splitByRefinement(Varnode *vn,<span class="keyword">const</span> Address &amp;addr,<span class="keyword">const</span> vector&lt;int4&gt; &amp;refine,vector&lt;Varnode *&gt; &amp;split)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;{</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  Address curaddr = vn-&gt;getAddr();</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  int4 sz = vn-&gt;getSize();</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <a class="code" href="class_addr_space.html">AddrSpace</a> *spc = curaddr.getSpace();</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  uint4 diff = (uint4)spc-&gt;<a class="code" href="class_addr_space.html#aaf923ed847e9804b55ffa12a51202712">wrapOffset</a>(curaddr.getOffset() - addr.getOffset());</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  int4 cutsz = refine[diff];</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">if</span> (sz &lt;= cutsz) <span class="keywordflow">return</span>;  <span class="comment">// Already refined</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">while</span>(sz &gt; 0) {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    Varnode *vn2 = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(cutsz,curaddr);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    split.push_back(vn2);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    curaddr = curaddr + cutsz;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    sz -= cutsz;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    diff = (uint4)spc-&gt;<a class="code" href="class_addr_space.html#aaf923ed847e9804b55ffa12a51202712">wrapOffset</a>(curaddr.getOffset() - addr.getOffset());</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    cutsz = refine[diff];</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">if</span> (cutsz &gt; sz)</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      cutsz = sz;       <span class="comment">// Final piece</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;}</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="keywordtype">void</span> Heritage::refineRead(Varnode *vn,<span class="keyword">const</span> Address &amp;addr,<span class="keyword">const</span> vector&lt;int4&gt; &amp;refine,vector&lt;Varnode *&gt; &amp;newvn)</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;{</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  newvn.clear();</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  splitByRefinement(vn,addr,refine,newvn);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">if</span> (newvn.empty()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  Varnode *replacevn = fd-&gt;<a class="code" href="class_funcdata.html#a731f6fd415269577b7bb1943315b8a76">newUnique</a>(vn-&gt;getSize());</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  PcodeOp *op = vn-&gt;loneDescend(); <span class="comment">// Read is free so has 1 and only 1 descend</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  int4 slot = op-&gt;getSlot(vn);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  concatPieces(newvn,op,replacevn);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(op,replacevn,slot);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">if</span> (vn-&gt;hasNoDescend())</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa8657c4c04279316593adc6d2f389be5">deleteVarnode</a>(vn);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Refining non-free varnode&quot;</span>);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;}</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="keywordtype">void</span> Heritage::refineWrite(Varnode *vn,<span class="keyword">const</span> Address &amp;addr,<span class="keyword">const</span> vector&lt;int4&gt; &amp;refine,vector&lt;Varnode *&gt; &amp;newvn)</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;{</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  newvn.clear();</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  splitByRefinement(vn,addr,refine,newvn);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">if</span> (newvn.empty()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  Varnode *replacevn = fd-&gt;<a class="code" href="class_funcdata.html#a731f6fd415269577b7bb1943315b8a76">newUnique</a>(vn-&gt;getSize());</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  PcodeOp *def = vn-&gt;getDef();</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#ab2bd3523c574c5b303728ef4d880ec3a">opSetOutput</a>(def,replacevn);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  splitPieces(newvn,def,vn-&gt;getAddr(),vn-&gt;getSize(),replacevn);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#aab7f940f85609d395283520eca3a71f0">totalReplace</a>(vn,replacevn);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#aa8657c4c04279316593adc6d2f389be5">deleteVarnode</a>(vn);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;}</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="keywordtype">void</span> Heritage::refineInput(Varnode *vn,<span class="keyword">const</span> Address &amp;addr,<span class="keyword">const</span> vector&lt;int4&gt; &amp;refine,vector&lt;Varnode *&gt; &amp;newvn)</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;{</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  newvn.clear();</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  splitByRefinement(vn,addr,refine,newvn);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keywordflow">if</span> (newvn.empty()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  splitPieces(newvn,(PcodeOp *)0,vn-&gt;getAddr(),vn-&gt;getSize(),vn);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  vn-&gt;setWriteMask();</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;}</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="keywordtype">void</span> Heritage::remove13Refinement(vector&lt;int4&gt; &amp;refine)</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;{</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">if</span> (refine.empty()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  int4 pos = 0;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  int4 lastsize = refine[pos];</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  int4 cursize;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  pos += lastsize;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keywordflow">while</span>(pos &lt; refine.size()) {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    cursize = refine[pos];</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">if</span> (cursize == 0) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">if</span> (((lastsize==1)&amp;&amp;(cursize==3))||((lastsize==3)&amp;&amp;(cursize==1))) {</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      refine[pos-lastsize] = 4;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      lastsize = 4;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      pos += cursize;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      lastsize = cursize;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      pos += lastsize;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    }</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  }</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  </div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;}</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="keywordtype">bool</span> Heritage::refinement(<span class="keyword">const</span> Address &amp;addr,int4 size,<span class="keyword">const</span> vector&lt;Varnode *&gt; &amp;readvars,<span class="keyword">const</span> vector&lt;Varnode *&gt; &amp;writevars,<span class="keyword">const</span> vector&lt;Varnode *&gt; &amp;inputvars)</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;{</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordflow">if</span> (size &gt; 1024) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  vector&lt;int4&gt; refine(size+1,0);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  buildRefinement(refine,addr,size,readvars);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  buildRefinement(refine,addr,size,writevars);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  buildRefinement(refine,addr,size,inputvars);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  int4 lastpos = 0;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordflow">for</span>(int4 curpos=1;curpos &lt; size;++curpos) { <span class="comment">// Convert boundary points to partition sizes</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">if</span> (refine[curpos] != 0) {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      refine[lastpos] = curpos - lastpos;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      lastpos = curpos;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    }</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="keywordflow">if</span> (lastpos == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// No non-trivial refinements</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  refine[lastpos] = size-lastpos;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  remove13Refinement(refine);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  vector&lt;Varnode *&gt; newvn;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keywordflow">for</span>(uint4 i=0;i&lt;readvars.size();++i)</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    refineRead(readvars[i],addr,refine,newvn);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordflow">for</span>(uint4 i=0;i&lt;writevars.size();++i)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    refineWrite(writevars[i],addr,refine,newvn);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="keywordflow">for</span>(uint4 i=0;i&lt;inputvars.size();++i)</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    refineInput(inputvars[i],addr,refine,newvn);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">// Alter the disjoint cover (both locally and globally) to reflect our refinement</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <a class="code" href="class_location_map.html#a13612b4d0583b85205f3ad6476c2aef9">LocationMap::iterator</a> iter = disjoint.<a class="code" href="class_location_map.html#a46317268798a00ecc792e87a4a360bef">find</a>(addr);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  int4 pass = (*iter).second.pass;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  disjoint.<a class="code" href="class_location_map.html#a50624e32845eeea2cc26a7379c57111d">erase</a>(iter);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  iter = globaldisjoint.<a class="code" href="class_location_map.html#a46317268798a00ecc792e87a4a360bef">find</a>(addr);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  globaldisjoint.<a class="code" href="class_location_map.html#a50624e32845eeea2cc26a7379c57111d">erase</a>(iter);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  Address curaddr = addr;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  int4 cut = 0;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  int4 intersect;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordflow">while</span>(cut &lt; size) {</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    int4 sz = refine[cut];</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    disjoint.<a class="code" href="class_location_map.html#a72014909f852e240636856c3fec0ca04">add</a>(curaddr,sz,pass,intersect);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    globaldisjoint.<a class="code" href="class_location_map.html#a72014909f852e240636856c3fec0ca04">add</a>(curaddr,sz,pass,intersect);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    cut += sz;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    curaddr = curaddr + sz;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;}</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="keywordtype">void</span> Heritage::guardInput(<span class="keyword">const</span> Address &amp;addr,int4 size,vector&lt;Varnode *&gt; &amp;input)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;{</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">if</span> (input.empty()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="comment">// If there is only one input and it fills everything</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="comment">// it will get linked in automatically</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordflow">if</span> ((input.size()==1)&amp;&amp;(input[0]-&gt;getSize() == size)) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="comment">// Otherwise we need to make sure there are no holes</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  int4 i = 0;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <a class="code" href="types_8h.html#a2db313c5d32a12b01d26ac9b3bca178f">uintb</a> cur = addr.getOffset(); <span class="comment">// Range that needs to be covered</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <a class="code" href="types_8h.html#a2db313c5d32a12b01d26ac9b3bca178f">uintb</a> end = cur + size;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="comment">//  bool seenunspliced = false;</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  Varnode *vn;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  vector&lt;Varnode *&gt; newinput;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">// Make sure the input range is filled</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">while</span>(cur &lt; end) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">if</span> (i&lt;input.size()) {</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      vn = input[i];</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">if</span> (vn-&gt;getOffset()&gt;cur) {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    int4 sz = vn-&gt;getOffset() - cur;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    vn = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(sz,Address(addr.getSpace(),cur));</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    vn = fd-&gt;<a class="code" href="class_funcdata.html#a84a9880613a03f3aea65acf3dd1343d6">setInputVarnode</a>(vn);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">//  seenunspliced = true;</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="comment">//  if (vn-&gt;hasNoDescend())</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">//    seenunspliced = true;</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    i += 1;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      }</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    }</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      int4 sz = end-cur;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      vn = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(sz,Address(addr.getSpace(),cur));</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      vn = fd-&gt;<a class="code" href="class_funcdata.html#a84a9880613a03f3aea65acf3dd1343d6">setInputVarnode</a>(vn);</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="comment">//      seenunspliced = true;</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    newinput.push_back(vn);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    cur += vn-&gt;getSize();</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  }</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="comment">// Now we need to make sure that all the inputs get linked</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="comment">// together into a single input</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordflow">if</span> (newinput.size()==1) <span class="keywordflow">return</span>; <span class="comment">// Will get linked in automatically</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordflow">for</span>(uint4 i=0;i&lt;newinput.size();++i)</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    newinput[i]-&gt;setWriteMask();</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">//   if (!seenunspliced) {</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">//     // Check to see if a concatenation of inputs already exists</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">//     // If it existed already it would be defined at fd-&gt;getAddress()</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">//     // and it would have full size</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">//     VarnodeLocSet::const_iterator iter,enditer;</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">//     iter = fd-&gt;beginLoc(size,addr,fd-&gt;getAddress());</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">//     enditer = fd-&gt;endLoc(size,addr,fd-&gt;getAddress());</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">//     if (iter != enditer) return; // It already exists</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">//   }</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  Varnode *newout = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(size,addr);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  concatPieces(newinput,(PcodeOp *)0,newout)-&gt;setActiveHeritage();</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;}</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="preprocessor">#ifdef DFSVERIFY_DEBUG</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> verify_dfs(<span class="keyword">const</span> vector&lt;FlowBlock *&gt; &amp;list,vector&lt;vector&lt;FlowBlock *&gt;&gt; &amp;domchild)</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;{</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  int4 count = 0;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  vector&lt;int4&gt; path;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  path.push_back(0);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordflow">if</span> (list[0]-&gt;getIndex() != 0)</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Initial block is not index 0&quot;</span>);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  count += 1;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">while</span>(!path.empty()) {</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    int4 cur = path.back();</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    int4 child;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <a class="code" href="class_flow_block.html">FlowBlock</a> *bl;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">for</span>(child=0;child&lt;domchild[cur].size();++child) {</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      bl = domchild[cur][child];</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>() == count)</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">if</span> (child == domchild[cur].size())</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      path.pop_back();</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      path.push_back(bl-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>());</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      count += 1;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    }</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  }</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">if</span> (count != list.size())</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;dfs does not verify&quot;</span>);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;}</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="keywordtype">void</span> Heritage::splitJoinLevel(vector&lt;Varnode *&gt; &amp;lastcombo,vector&lt;Varnode *&gt; &amp;nextlev,<a class="code" href="class_join_record.html">JoinRecord</a> *joinrec)</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;{</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  int4 numpieces = joinrec-&gt;<a class="code" href="class_join_record.html#a18d9eb13c87a49511865fab244aa69f5">numPieces</a>();</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  int4 recnum=0;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="keywordflow">for</span>(int4 i=0;i&lt;lastcombo.size();++i) {</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    Varnode *curvn = lastcombo[i];</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">if</span> (curvn-&gt;getSize() == joinrec-&gt;<a class="code" href="class_join_record.html#a5d3feebaadef123349cda1564717b9d7">getPiece</a>(recnum).<a class="code" href="struct_varnode_data.html#a50d39ae46d51c8854b962f3ec4ee4e25">size</a>) {</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      nextlev.push_back(curvn);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      nextlev.push_back((Varnode *)0);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      recnum += 1;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    }</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      int4 sizeaccum = 0;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      int4 j;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <span class="keywordflow">for</span>(j=recnum;j&lt;numpieces;++j) {</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    sizeaccum += joinrec-&gt;<a class="code" href="class_join_record.html#a5d3feebaadef123349cda1564717b9d7">getPiece</a>(recnum).<a class="code" href="struct_varnode_data.html#a50d39ae46d51c8854b962f3ec4ee4e25">size</a>;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">if</span> (sizeaccum == curvn-&gt;getSize()) {</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      j += 1;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    }</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      }</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      int4 numinhalf = (j-recnum) / 2;  <span class="comment">// Will be at least 1</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      sizeaccum = 0;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keywordflow">for</span>(int4 k=0;k&lt;numinhalf;++k)</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    sizeaccum += joinrec-&gt;<a class="code" href="class_join_record.html#a5d3feebaadef123349cda1564717b9d7">getPiece</a>(recnum+k).<a class="code" href="struct_varnode_data.html#a50d39ae46d51c8854b962f3ec4ee4e25">size</a>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      Varnode *mosthalf,*leasthalf;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="keywordflow">if</span> (numinhalf == 1)</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    mosthalf = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(sizeaccum,joinrec-&gt;<a class="code" href="class_join_record.html#a5d3feebaadef123349cda1564717b9d7">getPiece</a>(recnum).<a class="code" href="struct_varnode_data.html#a1a69a5187f7a6376c0c93c08962ea68d">space</a>,joinrec-&gt;<a class="code" href="class_join_record.html#a5d3feebaadef123349cda1564717b9d7">getPiece</a>(recnum).<a class="code" href="struct_varnode_data.html#a1a511384ee72e847b51423cc99c8233e">offset</a>);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    mosthalf = fd-&gt;<a class="code" href="class_funcdata.html#a731f6fd415269577b7bb1943315b8a76">newUnique</a>(sizeaccum);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <span class="keywordflow">if</span> ((j-recnum)==2) {</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_varnode_data.html">VarnodeData</a> &amp;vdata( joinrec-&gt;<a class="code" href="class_join_record.html#a5d3feebaadef123349cda1564717b9d7">getPiece</a>(recnum+1) );</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    leasthalf = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(vdata.size,vdata.space,vdata.offset);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      }</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    leasthalf = fd-&gt;<a class="code" href="class_funcdata.html#a731f6fd415269577b7bb1943315b8a76">newUnique</a>(curvn-&gt;getSize() - sizeaccum);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      nextlev.push_back(mosthalf);</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      nextlev.push_back(leasthalf);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      recnum = j;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    }</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  }</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;}</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keywordtype">void</span> Heritage::splitJoinRead(Varnode *vn,<a class="code" href="class_join_record.html">JoinRecord</a> *joinrec)</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;{</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  PcodeOp *op = vn-&gt;loneDescend(); <span class="comment">// vn isFree, so loneDescend must be non-null</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  </div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  vector&lt;Varnode *&gt; lastcombo;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  vector&lt;Varnode *&gt; nextlev;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  lastcombo.push_back(vn);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordflow">while</span>(lastcombo.size() &lt; joinrec-&gt;<a class="code" href="class_join_record.html#a18d9eb13c87a49511865fab244aa69f5">numPieces</a>()) {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    nextlev.clear();</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    splitJoinLevel(lastcombo,nextlev,joinrec);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">for</span>(int4 i=0;i&lt;lastcombo.size();++i) {</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      Varnode *curvn = lastcombo[i];</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      Varnode *mosthalf = nextlev[2*i];</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      Varnode *leasthalf = nextlev[2*i+1];</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="keywordflow">if</span> (leasthalf == (Varnode *)0) <span class="keywordflow">continue</span>; <span class="comment">// Varnode didn&#39;t get split this level</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      PcodeOp *concat = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,op-&gt;getAddr());</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(concat,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a69a387d1e0b510d027e69bdde8f03caa">CPUI_PIECE</a>);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ab2bd3523c574c5b303728ef4d880ec3a">opSetOutput</a>(concat,curvn);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(concat,mosthalf,0);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(concat,leasthalf,1);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#a9dd86e17a47020d06ac8dfd3bb732fe5">opInsertBefore</a>(concat,op);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      mosthalf-&gt;setPrecisHi();  <span class="comment">// Set precision flags to trigger &quot;double precision&quot; rules</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      leasthalf-&gt;setPrecisLo();</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      op = concat;      <span class="comment">// Keep -op- as the earliest op in the concatenation construction</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    lastcombo.clear();</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">for</span>(int4 i=0;i&lt;nextlev.size();++i) {</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      Varnode *curvn = nextlev[i];</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordflow">if</span> (curvn != (Varnode *)0)</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    lastcombo.push_back(curvn);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  }</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;}</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="keywordtype">void</span> Heritage::splitJoinWrite(Varnode *vn,<a class="code" href="class_join_record.html">JoinRecord</a> *joinrec)</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;{</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  PcodeOp *op = vn-&gt;getDef();   <span class="comment">// vn cannot be free, either it has def, or it is input</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <a class="code" href="class_block_basic.html">BlockBasic</a> *bb = (<a class="code" href="class_block_basic.html">BlockBasic</a> *)fd-&gt;<a class="code" href="class_funcdata.html#add21153afa5eb571406d1f64b8b344db">getBasicBlocks</a>().<a class="code" href="class_block_graph.html#ac87b63ceb9f08a4f8667da43e25c7e5e">getBlock</a>(0);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  vector&lt;Varnode *&gt; lastcombo;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  vector&lt;Varnode *&gt; nextlev;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  lastcombo.push_back(vn);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordflow">while</span>(lastcombo.size() &lt; joinrec-&gt;<a class="code" href="class_join_record.html#a18d9eb13c87a49511865fab244aa69f5">numPieces</a>()) {</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    nextlev.clear();</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    splitJoinLevel(lastcombo,nextlev,joinrec);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordflow">for</span>(int4 i=0;i&lt;lastcombo.size();++i) {</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      Varnode *curvn = lastcombo[i];</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      Varnode *mosthalf = nextlev[2*i];</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      Varnode *leasthalf = nextlev[2*i+1];</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordflow">if</span> (leasthalf == (Varnode *)0) <span class="keywordflow">continue</span>; <span class="comment">// Varnode didn&#39;t get split this level</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      PcodeOp *split;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keywordflow">if</span> (vn-&gt;isInput())</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    split = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,bb-&gt;<a class="code" href="class_block_basic.html#a779d71352d86f6af4342b419713c03d5">getStart</a>());</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    split = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,op-&gt;getAddr());</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(split,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a>);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ab2bd3523c574c5b303728ef4d880ec3a">opSetOutput</a>(split,mosthalf);</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(split,curvn,0);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(split,fd-&gt;<a class="code" href="class_funcdata.html#af58542dbcc89f4b84ffc8834b023125b">newConstant</a>(4,leasthalf-&gt;getSize()),1);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keywordflow">if</span> (op == (PcodeOp *)0) </div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#ae6341eb8ca8a8004f1c77a8e8147a286">opInsertBegin</a>(split,bb);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#a3320ad92e11a48a06e21b8a55395a56b">opInsertAfter</a>(split,op);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      op = split;       <span class="comment">// Keep -op- as the latest op in the split construction</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      split = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(2,op-&gt;getAddr());</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(split,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a>);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ab2bd3523c574c5b303728ef4d880ec3a">opSetOutput</a>(split,leasthalf);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(split,curvn,0);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(split,fd-&gt;<a class="code" href="class_funcdata.html#af58542dbcc89f4b84ffc8834b023125b">newConstant</a>(4,0),1);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#a3320ad92e11a48a06e21b8a55395a56b">opInsertAfter</a>(split,op);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      mosthalf-&gt;setPrecisHi();  <span class="comment">// Make sure we set the precision flags to trigger &quot;double precision&quot; rules</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      leasthalf-&gt;setPrecisLo();</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      op = split;       <span class="comment">// Keep -op- as the latest op in the split construction</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    }</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    lastcombo.clear();</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">for</span>(int4 i=0;i&lt;nextlev.size();++i) {</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      Varnode *curvn = nextlev[i];</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keywordflow">if</span> (curvn != (Varnode *)0)</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    lastcombo.push_back(curvn);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    }</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  }</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;}</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="keywordtype">void</span> Heritage::floatExtensionRead(Varnode *vn,<a class="code" href="class_join_record.html">JoinRecord</a> *joinrec)</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;{</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  PcodeOp *op = vn-&gt;loneDescend(); <span class="comment">// vn isFree, so loneDescend must be non-null</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  PcodeOp *trunc = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(1,op-&gt;getAddr());</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <span class="keyword">const</span> <a class="code" href="struct_varnode_data.html">VarnodeData</a> &amp;vdata( joinrec-&gt;<a class="code" href="class_join_record.html#a5d3feebaadef123349cda1564717b9d7">getPiece</a>(0) ); <span class="comment">// Float extensions have exactly 1 piece</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  Varnode *bigvn = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(vdata.size,vdata.space,vdata.offset);</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(trunc,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aab409a4f8049204cbe5be65787497842">CPUI_FLOAT_FLOAT2FLOAT</a>);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#ab2bd3523c574c5b303728ef4d880ec3a">opSetOutput</a>(trunc,vn);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(trunc,bigvn,0);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#a9dd86e17a47020d06ac8dfd3bb732fe5">opInsertBefore</a>(trunc,op);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;}</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="keywordtype">void</span> Heritage::floatExtensionWrite(Varnode *vn,<a class="code" href="class_join_record.html">JoinRecord</a> *joinrec)</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;{</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  PcodeOp *op = vn-&gt;getDef();</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <a class="code" href="class_block_basic.html">BlockBasic</a> *bb = (<a class="code" href="class_block_basic.html">BlockBasic</a> *)fd-&gt;<a class="code" href="class_funcdata.html#add21153afa5eb571406d1f64b8b344db">getBasicBlocks</a>().<a class="code" href="class_block_graph.html#ac87b63ceb9f08a4f8667da43e25c7e5e">getBlock</a>(0);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  PcodeOp *ext;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="keywordflow">if</span> (vn-&gt;isInput())</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    ext = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(1,bb-&gt;<a class="code" href="class_block_basic.html#a779d71352d86f6af4342b419713c03d5">getStart</a>());</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    ext = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(1,op-&gt;getAddr());</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="keyword">const</span> <a class="code" href="struct_varnode_data.html">VarnodeData</a> &amp;vdata( joinrec-&gt;<a class="code" href="class_join_record.html#a5d3feebaadef123349cda1564717b9d7">getPiece</a>(0) ); <span class="comment">// Float extensions have exactly 1 piece</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(ext,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aab409a4f8049204cbe5be65787497842">CPUI_FLOAT_FLOAT2FLOAT</a>);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#a100e6704e4c245e076170268d31b47ec">newVarnodeOut</a>( vdata.size, vdata.getAddr(),ext);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>( ext, vn, 0);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="keywordflow">if</span> (op == (PcodeOp *)0)</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#ae6341eb8ca8a8004f1c77a8e8147a286">opInsertBegin</a>(ext,bb);</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#a3320ad92e11a48a06e21b8a55395a56b">opInsertAfter</a>(ext,op);</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;}</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="keywordtype">void</span> Heritage::processJoins(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;{</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <a class="code" href="class_addr_space.html">AddrSpace</a> *joinspace = fd-&gt;<a class="code" href="class_funcdata.html#a47b9d753da3c1caf025981ced51c1e96">getArch</a>()-&gt;<a class="code" href="class_addr_space_manager.html#addc2a210ade7c84962711a962e27dc32">getJoinSpace</a>();</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  VarnodeLocSet::const_iterator iter,enditer;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  iter = fd-&gt;<a class="code" href="class_funcdata.html#ac34a257742ad827bd278d0b35e15af74">beginLoc</a>(joinspace);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  enditer = fd-&gt;<a class="code" href="class_funcdata.html#a49f4e57094c47d431d81545f28172c1f">endLoc</a>(joinspace);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  </div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="keywordflow">while</span>(iter != enditer) {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    Varnode *vn = *iter++;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">if</span> (vn-&gt;getSpace() != joinspace) <span class="keywordflow">break</span>; <span class="comment">// New varnodes may get inserted before enditer</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <a class="code" href="class_join_record.html">JoinRecord</a> *joinrec = fd-&gt;<a class="code" href="class_funcdata.html#a47b9d753da3c1caf025981ced51c1e96">getArch</a>()-&gt;<a class="code" href="class_addr_space_manager.html#adff0f9e662ebffdf724dca82b6b544bb">findJoin</a>(vn-&gt;getOffset());</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <a class="code" href="class_addr_space.html">AddrSpace</a> *piecespace = joinrec-&gt;<a class="code" href="class_join_record.html#a5d3feebaadef123349cda1564717b9d7">getPiece</a>(0).<a class="code" href="struct_varnode_data.html#a1a69a5187f7a6376c0c93c08962ea68d">space</a>;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">if</span> (joinrec-&gt;<a class="code" href="class_join_record.html#a71e39715b107db55fa5c737457877b3a">getUnified</a>().<a class="code" href="struct_varnode_data.html#a50d39ae46d51c8854b962f3ec4ee4e25">size</a> != vn-&gt;getSize())</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Joined varnode does not match size of record&quot;</span>);</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keywordflow">if</span> (vn-&gt;isFree()) {</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <span class="keywordflow">if</span> (joinrec-&gt;<a class="code" href="class_join_record.html#a0a9314d1dd21efb75d8851aa05c387c4">isFloatExtension</a>())</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    floatExtensionRead(vn,joinrec);</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    splitJoinRead(vn,joinrec);</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    }</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="class_heritage_info.html">HeritageInfo</a> *info = getInfo(piecespace);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordflow">if</span> (pass != info-&gt;delay) <span class="keywordflow">continue</span>; <span class="comment">// It is too soon to heritage this space</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    </div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">if</span> (joinrec-&gt;<a class="code" href="class_join_record.html#a0a9314d1dd21efb75d8851aa05c387c4">isFloatExtension</a>())</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      floatExtensionWrite(vn,joinrec);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      splitJoinWrite(vn,joinrec);   <span class="comment">// Only do this once for a particular varnode</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  }</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;}</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="keywordtype">void</span> Heritage::buildADT(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;{</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="keyword">const</span> <a class="code" href="class_block_graph.html">BlockGraph</a> &amp;bblocks(fd-&gt;<a class="code" href="class_funcdata.html#add21153afa5eb571406d1f64b8b344db">getBasicBlocks</a>());</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  int4 size = bblocks.<a class="code" href="class_block_graph.html#a12bc7480ffcc4c163a2a2cd800742f09">getSize</a>();</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  vector&lt;int4&gt; a(size);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  vector&lt;int4&gt; b(size,0);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  vector&lt;int4&gt; t(size,0);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  vector&lt;int4&gt; z(size);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  vector&lt;FlowBlock *&gt; upstart,upend;    <span class="comment">// Up edges (node pair)</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <a class="code" href="class_flow_block.html">FlowBlock</a> *x,*u,*v;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  int4 i,j,k,l;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  augment.clear();</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  augment.resize(size);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  flags.clear();</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  flags.resize(size,0);</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  bblocks.buildDomTree(domchild);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="preprocessor">#ifdef DFSVERIFY_DEBUG</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  verify_dfs(bblocks.getList(),domchild);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  maxdepth = bblocks.buildDomDepth(depth);</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;size;++i) {</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    x = bblocks.getBlock(i);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordflow">for</span>(j=0;j&lt;domchild[i].size();++j) {</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      v = domchild[i][j];</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <span class="keywordflow">for</span>(k=0;k&lt;v-&gt;<a class="code" href="class_flow_block.html#aab379442c099264f10c1f1f3b9ecf5fe">sizeIn</a>();++k) {</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    u = v-&gt;<a class="code" href="class_flow_block.html#acbb1f895710c8339bd21d9c7a3200322">getIn</a>(k);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">if</span> (u != v-&gt;<a class="code" href="class_flow_block.html#a4b223b939cafc0405323dd0d6dc749d6">getImmedDom</a>()) { <span class="comment">// If u-&gt;v is an up-edge</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      upstart.push_back(u); <span class="comment">// Store edge (in dfs order)</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      upend.push_back(v);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      b[u-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>()] += 1;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      t[x-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>()] += 1;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    }</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      }</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  }</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="keywordflow">for</span>(i=size-1;i&gt;=0;--i) {</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    k=0;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    l=0;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keywordflow">for</span>(j=0;j&lt;domchild[i].size();++j) {</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      k += a[ domchild[i][j]-&gt;getIndex() ];</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      l += z[ domchild[i][j]-&gt;getIndex() ];</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    }</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    a[i] = b[i] - t[i] + k;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    z[i] = 1 + l;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keywordflow">if</span> ((domchild[i].size()==0)||(z[i] &gt; a[i] + 1)) {</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      flags[i] |= boundary_node; <span class="comment">// Mark this node as a boundary node</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      z[i] = 1;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    }</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  }</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  z[0] = -1;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keywordflow">for</span>(i=1;i&lt;size;++i) {</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    j = bblocks.getBlock(i)-&gt;getImmedDom()-&gt;getIndex();</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="keywordflow">if</span> ((flags[j]&amp;boundary_node)!=0) <span class="comment">// If j is a boundary node</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      z[i] = j;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      z[i] = z[j];</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  }</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;upstart.size();++i) {</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    v = upend[i];</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    j = v-&gt;<a class="code" href="class_flow_block.html#a4b223b939cafc0405323dd0d6dc749d6">getImmedDom</a>()-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>();</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    k = upstart[i]-&gt;getIndex();</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordflow">while</span>(j &lt; k) {      <span class="comment">// while idom(v) properly dominates u</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      augment[ k ].push_back(v);</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      k = z[k];</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    }</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  }</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;}</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="keywordtype">void</span> Heritage::visitIncr(<a class="code" href="class_flow_block.html">FlowBlock</a> *qnode,<a class="code" href="class_flow_block.html">FlowBlock</a> *vnode)</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;{</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  int4 i,j,k;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <a class="code" href="class_flow_block.html">FlowBlock</a> *v,*child;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  vector&lt;FlowBlock *&gt;::iterator iter,enditer;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  </div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  i = vnode-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>();</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  j = qnode-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>();</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  iter = augment[i].begin();</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  enditer = augment[i].end();</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="keywordflow">for</span>(;iter!=enditer;++iter) {</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    v = *iter;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="keywordflow">if</span> (v-&gt;<a class="code" href="class_flow_block.html#a4b223b939cafc0405323dd0d6dc749d6">getImmedDom</a>()-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>() &lt; j) { <span class="comment">// If idom(v) is strict ancestor of qnode</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      k = v-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>();</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keywordflow">if</span> ((flags[k]&amp;merged_node)==0) {</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    merge.push_back(v);</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    flags[k] |= merged_node;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keywordflow">if</span> ((flags[k]&amp;mark_node)==0) { <span class="comment">// If v is not marked</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    flags[k] |= mark_node;  <span class="comment">// then mark it</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    pq.<a class="code" href="class_priority_queue.html#a8abe49ecb70033726324497f4aafdb74">insert</a>(v,depth[k]); <span class="comment">// insert it into the queue</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      }</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    }</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  }</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="keywordflow">if</span> ((flags[i]&amp;boundary_node)==0) { <span class="comment">// If vnode is not a boundary node</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordflow">for</span>(j=0;j&lt;domchild[i].size();++j) {</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      child = domchild[i][j];</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="keywordflow">if</span> ((flags[child-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>()]&amp;mark_node)==0)  <span class="comment">// If the child is not marked</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    visitIncr(qnode,child);</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  }</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;}</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="keywordtype">void</span> Heritage::calcMultiequals(<span class="keyword">const</span> vector&lt;Varnode *&gt; &amp;write)</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;{</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  pq.<a class="code" href="class_priority_queue.html#a75ec253ec066ea6dc172f1f8bd88758b">reset</a>(maxdepth);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  merge.clear();</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  int4 i,j;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <a class="code" href="class_flow_block.html">FlowBlock</a> *bl;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                <span class="comment">// Place write blocks into the pq</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;write.size();++i) {</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    bl = write[i]-&gt;getDef()-&gt;<a class="code" href="class_flow_block.html#aa09d7d958c190fa86a30dbe9ac23c78f">getParent</a>(); <span class="comment">// Get block where this write occurs</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    j = bl-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>();</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">if</span> ((flags[j]&amp;mark_node)!=0) <span class="keywordflow">continue</span>; <span class="comment">// Already put in</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    pq.<a class="code" href="class_priority_queue.html#a8abe49ecb70033726324497f4aafdb74">insert</a>(bl,depth[j]); <span class="comment">// Insert input node into priority queue</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    flags[j] |= mark_node;  <span class="comment">// mark input node</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  }</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="keywordflow">if</span> ((flags[0]&amp;mark_node)==0) { <span class="comment">// Make sure start node is in input</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    pq.<a class="code" href="class_priority_queue.html#a8abe49ecb70033726324497f4aafdb74">insert</a>(fd-&gt;<a class="code" href="class_funcdata.html#add21153afa5eb571406d1f64b8b344db">getBasicBlocks</a>().<a class="code" href="class_block_graph.html#ac87b63ceb9f08a4f8667da43e25c7e5e">getBlock</a>(0),depth[0]);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    flags[0] |= mark_node;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="keywordflow">while</span>(!pq.<a class="code" href="class_priority_queue.html#aa52c8c07deead26f255cdbe92a0acd4e">empty</a>()) {</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    bl = pq.<a class="code" href="class_priority_queue.html#a6cd7194cc2cb973f33158a1d7dc7acc9">extract</a>();      <span class="comment">// Extract the next block</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    visitIncr(bl,bl);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  }</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;flags.size();++i)</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    flags[i] &amp;= ~(mark_node|merged_node); <span class="comment">// Clear marks from nodes</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;}</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="keywordtype">void</span> Heritage::renameRecurse(<a class="code" href="class_block_basic.html">BlockBasic</a> *bl,<a class="code" href="heritage_8hh.html#a06c866be068de18f657eeea50b3790ba">VariableStack</a> &amp;varstack)</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;{</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  vector&lt;Varnode *&gt; writelist;  <span class="comment">// List varnodes that are written in this block</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <a class="code" href="class_block_basic.html">BlockBasic</a> *subbl;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  list&lt;PcodeOp *&gt;::iterator oiter,suboiter;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  PcodeOp *op,*multiop;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  Varnode *vnout,*vnin,*vnnew;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  int4 i,slot;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <span class="keywordflow">for</span>(oiter=bl-&gt;<a class="code" href="class_block_basic.html#a3ddd779a5af8cb12e6fc069bd49ddb6c">beginOp</a>();oiter!=bl-&gt;<a class="code" href="class_block_basic.html#abd3fc70635403ddb5c85c07b19c6f6b3">endOp</a>();++oiter) {</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    op = *oiter;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">if</span> (op-&gt;code() != <a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a108d223da48e77fa181637fc3e75d9e8">CPUI_MULTIEQUAL</a>) {</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                <span class="comment">// First replace reads with top of stack</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <span class="keywordflow">for</span>(slot=0;slot&lt;op-&gt;numInput();++slot) {</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    vnin = op-&gt;<a class="code" href="class_flow_block.html#acbb1f895710c8339bd21d9c7a3200322">getIn</a>(slot);</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordflow">if</span> (vnin-&gt;isHeritageKnown()) <span class="keywordflow">continue</span>; <span class="comment">// not free</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="keywordflow">if</span> (!vnin-&gt;isActiveHeritage()) <span class="keywordflow">continue</span>; <span class="comment">// Not being heritaged this round</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    vnin-&gt;clearActiveHeritage();</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    vector&lt;Varnode *&gt; &amp;stack( varstack[ vnin-&gt;getAddr() ] );</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">if</span> (stack.empty()) {</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      vnnew = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(vnin-&gt;getSize(),vnin-&gt;getAddr());</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      vnnew = fd-&gt;<a class="code" href="class_funcdata.html#a84a9880613a03f3aea65acf3dd1343d6">setInputVarnode</a>(vnnew);</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      stack.push_back(vnnew);</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    }</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      vnnew = stack.back();</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                <span class="comment">// INDIRECTs and their op really happen AT SAME TIME</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keywordflow">if</span> (vnnew-&gt;isWritten() &amp;&amp; (vnnew-&gt;getDef()-&gt;code()==<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aa89e33b07a26ca7d26b54315e45c8424">CPUI_INDIRECT</a>)) {</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_pcode_op.html#a41be82b850ff5185e51268aead2c2802">PcodeOp::getOpFromConst</a>(vnnew-&gt;getDef()-&gt;getIn(1)-&gt;getAddr()) == op) {</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        <span class="keywordflow">if</span> (stack.size()==1) {</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;          vnnew = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(vnin-&gt;getSize(),vnin-&gt;getAddr());</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;          vnnew = fd-&gt;<a class="code" href="class_funcdata.html#a84a9880613a03f3aea65acf3dd1343d6">setInputVarnode</a>(vnnew);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;          stack.insert(stack.begin(),vnnew);</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        }</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;          vnnew = stack[stack.size()-2];</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      }</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    }</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(op,vnnew,slot);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keywordflow">if</span> (vnin-&gt;hasNoDescend())</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa8657c4c04279316593adc6d2f389be5">deleteVarnode</a>(vnin);</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      }</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    }</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                <span class="comment">// Then push writes onto stack</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    vnout = op-&gt;getOut();</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keywordflow">if</span> (vnout == (Varnode *)0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">if</span> (!vnout-&gt;isActiveHeritage()) <span class="keywordflow">continue</span>; <span class="comment">// Not a normalized write</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    vnout-&gt;clearActiveHeritage();</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    varstack[ vnout-&gt;getAddr() ].push_back(vnout); <span class="comment">// Push write onto stack</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    writelist.push_back(vnout);</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  }</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;bl-&gt;<a class="code" href="class_flow_block.html#abf4424ddc9e448fcd52e72ebe9fb8a2b">sizeOut</a>();++i) {</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    subbl = (<a class="code" href="class_block_basic.html">BlockBasic</a> *)bl-&gt;<a class="code" href="class_flow_block.html#ab95b430d4c8470c379dba93613c3073b">getOut</a>(i);</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    slot = bl-&gt;<a class="code" href="class_flow_block.html#a7ebfd2366874120b2d582313386cc28f">getOutRevIndex</a>(i);</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">for</span>(suboiter=subbl-&gt;<a class="code" href="class_block_basic.html#a3ddd779a5af8cb12e6fc069bd49ddb6c">beginOp</a>();suboiter!=subbl-&gt;<a class="code" href="class_block_basic.html#abd3fc70635403ddb5c85c07b19c6f6b3">endOp</a>();++suboiter) {</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      multiop = *suboiter;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      <span class="keywordflow">if</span> (multiop-&gt;code()!=<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a108d223da48e77fa181637fc3e75d9e8">CPUI_MULTIEQUAL</a>) <span class="keywordflow">break</span>; <span class="comment">// For each MULTIEQUAL</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      vnin = multiop-&gt;getIn(slot);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      <span class="keywordflow">if</span> (!vnin-&gt;isHeritageKnown()) {</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    vector&lt;Varnode *&gt; &amp;stack( varstack[ vnin-&gt;getAddr() ] );</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keywordflow">if</span> (stack.empty()) {</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      vnnew = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(vnin-&gt;getSize(),vnin-&gt;getAddr());</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      vnnew = fd-&gt;<a class="code" href="class_funcdata.html#a84a9880613a03f3aea65acf3dd1343d6">setInputVarnode</a>(vnnew);</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      stack.push_back(vnnew);</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    }</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      vnnew = stack.back();</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(multiop,vnnew,slot);</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="keywordflow">if</span> (vnin-&gt;hasNoDescend())</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#aa8657c4c04279316593adc6d2f389be5">deleteVarnode</a>(vnin);</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      }</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    }</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  }</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                <span class="comment">// Now we recurse to subtrees</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  i = bl-&gt;<a class="code" href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">getIndex</a>();</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="keywordflow">for</span>(slot=0;slot&lt;domchild[i].size();++slot)</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    renameRecurse((<a class="code" href="class_block_basic.html">BlockBasic</a> *)domchild[i][slot],varstack);</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                <span class="comment">// Now we pop this blocks writes of the stack</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;writelist.size();++i) {</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    vnout = writelist[i];</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    varstack[vnout-&gt;getAddr()].pop_back();</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  }</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;}</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="keywordtype">void</span> Heritage::bumpDeadcodeDelay(Varnode *vn)</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;{</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <a class="code" href="class_addr_space.html">AddrSpace</a> *spc = vn-&gt;getSpace();</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordflow">if</span> ((spc-&gt;<a class="code" href="class_addr_space.html#ab548f4158529a29122d4d0a30d94ed98">getType</a>() != <a class="code" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231ac6a759a590195b56c099150c63cdd7b2">IPTR_PROCESSOR</a>)&amp;&amp;(spc-&gt;<a class="code" href="class_addr_space.html#ab548f4158529a29122d4d0a30d94ed98">getType</a>() != <a class="code" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231aebea73c9a75ffad2803a312d021932b5">IPTR_SPACEBASE</a>))</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="keywordflow">return</span>;         <span class="comment">// Not the right kind of space</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordflow">if</span> (spc-&gt;<a class="code" href="class_addr_space.html#a63b510a07fd8450dc432d7e671f79f66">getDelay</a>() != spc-&gt;<a class="code" href="class_addr_space.html#a51295f26c99891cb310af0eb0c20d4db">getDeadcodeDelay</a>())</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">return</span>;         <span class="comment">// there is already a global delay</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="keywordflow">if</span> (fd-&gt;<a class="code" href="class_funcdata.html#ac48d087ed5fbf901cfa608d8f44b6d5c">getOverride</a>().<a class="code" href="class_override.html#a3845c19e46f983d2034e06bb1980b672">hasDeadcodeDelay</a>(spc))</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="keywordflow">return</span>;         <span class="comment">// A delay has already been installed</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#ac48d087ed5fbf901cfa608d8f44b6d5c">getOverride</a>().<a class="code" href="class_override.html#a2e55dd5f8157f3f7660c863eb7d036f9">insertDeadcodeDelay</a>(spc,spc-&gt;<a class="code" href="class_addr_space.html#a51295f26c99891cb310af0eb0c20d4db">getDeadcodeDelay</a>()+1);</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  fd-&gt;<a class="code" href="class_funcdata.html#af21c852eb9f606c5cd19fb2456927ecd">setRestartPending</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;}</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"><a class="line" href="class_heritage.html#a68d25aa348dd9e8c5f13d708b2310772"> 1571</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_heritage.html#a68d25aa348dd9e8c5f13d708b2310772">Heritage::rename</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;{</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <a class="code" href="heritage_8hh.html#a06c866be068de18f657eeea50b3790ba">VariableStack</a> varstack;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  renameRecurse((<a class="code" href="class_block_basic.html">BlockBasic</a> *)fd-&gt;<a class="code" href="class_funcdata.html#add21153afa5eb571406d1f64b8b344db">getBasicBlocks</a>().<a class="code" href="class_block_graph.html#ac87b63ceb9f08a4f8667da43e25c7e5e">getBlock</a>(0),varstack);</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  disjoint.<a class="code" href="class_location_map.html#a76bf666b4ad4b511cfd0290b9b04aa72">clear</a>();</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;}</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div><div class="line"><a name="l01583"></a><span class="lineno"><a class="line" href="class_heritage.html#acf14995e58b23df915ad06e9ff7f1165"> 1583</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_heritage.html#acf14995e58b23df915ad06e9ff7f1165">Heritage::placeMultiequals</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;{</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <a class="code" href="class_location_map.html#a13612b4d0583b85205f3ad6476c2aef9">LocationMap::iterator</a> iter;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  vector&lt;Varnode *&gt; readvars;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  vector&lt;Varnode *&gt; writevars;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  vector&lt;Varnode *&gt; inputvars;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  PcodeOp *multiop;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  Varnode *vnin;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <a class="code" href="class_block_basic.html">BlockBasic</a> *bl;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  int4 max;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="keywordflow">for</span>(iter=disjoint.<a class="code" href="class_location_map.html#ae639047ed4f014b5a05511a65e886398">begin</a>();iter!=disjoint.<a class="code" href="class_location_map.html#a9d4bddedee005e780986d9752b93e4f0">end</a>();++iter) { </div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    Address addr = (*iter).first;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    int4 size = (*iter).second.size;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    readvars.clear();</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    writevars.clear();</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    inputvars.clear();</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    max = collect(addr,size,readvars,writevars,inputvars); <span class="comment">// Collect reads/writes</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keywordflow">if</span> ((size &gt; 4)&amp;&amp;(max &lt; size)) {</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <span class="keywordflow">if</span> (refinement(addr,size,readvars,writevars,inputvars)) {</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    iter = disjoint.<a class="code" href="class_location_map.html#a46317268798a00ecc792e87a4a360bef">find</a>(addr);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    size =(*iter).second.size;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    readvars.clear();</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    writevars.clear();</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    inputvars.clear();</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    collect(addr,size,readvars,writevars,inputvars);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      }</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    }</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">if</span> (readvars.empty() &amp;&amp; (addr.getSpace()-&gt;getType() == <a class="code" href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231a1eef2cfc279c246cc7ea0387d8c0aa66">IPTR_INTERNAL</a>))</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    guardInput(addr,size,inputvars);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    guard(addr,size,readvars,writevars,inputvars);</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">if</span> (readvars.empty()&amp;&amp;writevars.empty()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    calcMultiequals(writevars); <span class="comment">// Calculate where MULTIEQUALs go</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">for</span>(int4 i=0;i&lt;merge.size();++i) {</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      bl = (<a class="code" href="class_block_basic.html">BlockBasic</a> *) merge[i];</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      multiop = fd-&gt;<a class="code" href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">newOp</a>(bl-&gt;<a class="code" href="class_flow_block.html#aab379442c099264f10c1f1f3b9ecf5fe">sizeIn</a>(),bl-&gt;<a class="code" href="class_block_basic.html#a779d71352d86f6af4342b419713c03d5">getStart</a>());</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      Varnode *vnout = fd-&gt;<a class="code" href="class_funcdata.html#a100e6704e4c245e076170268d31b47ec">newVarnodeOut</a>(size,addr,multiop);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      vnout-&gt;setActiveHeritage();</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">opSetOpcode</a>(multiop,<a class="code" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a108d223da48e77fa181637fc3e75d9e8">CPUI_MULTIEQUAL</a>); <span class="comment">// Create each MULTIEQUAL</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <span class="keywordflow">for</span>(int4 j=0;j&lt;bl-&gt;<a class="code" href="class_flow_block.html#aab379442c099264f10c1f1f3b9ecf5fe">sizeIn</a>();++j) {</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    vnin = fd-&gt;<a class="code" href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">newVarnode</a>(size,addr);</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">opSetInput</a>(multiop,vnin,j);</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      }</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      fd-&gt;<a class="code" href="class_funcdata.html#ae6341eb8ca8a8004f1c77a8e8147a286">opInsertBegin</a>(multiop,bl);    <span class="comment">// Insert at beginning of block</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    }</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  }</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  merge.clear();</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;}</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div><div class="line"><a name="l01637"></a><span class="lineno"><a class="line" href="class_heritage.html#a7cca3fa6fe1e5d6241ca3e0f0a29af42"> 1637</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_heritage.html#a7cca3fa6fe1e5d6241ca3e0f0a29af42">Heritage::buildInfoList</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;{</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <span class="keywordflow">if</span> (!infolist.empty()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <a class="code" href="class_addr_space.html">AddrSpace</a> *spc;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="keyword">const</span> <a class="code" href="class_addr_space_manager.html">AddrSpaceManager</a> *manage = fd-&gt;<a class="code" href="class_funcdata.html#a47b9d753da3c1caf025981ced51c1e96">getArch</a>();</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keywordflow">for</span>(int4 i=0;i&lt;manage-&gt;<a class="code" href="class_addr_space_manager.html#ae2d22102a7ce6080918e82daafabbdfa">numSpaces</a>();++i) {</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    spc = manage-&gt;<a class="code" href="class_addr_space_manager.html#ad1a9a620e767ffe8bd929913f882e2a4">getSpace</a>(i);</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    infolist.push_back(<a class="code" href="class_heritage_info.html">HeritageInfo</a>(spc,spc-&gt;<a class="code" href="class_addr_space.html#a63b510a07fd8450dc432d7e671f79f66">getDelay</a>(),spc-&gt;<a class="code" href="class_addr_space.html#a51295f26c99891cb310af0eb0c20d4db">getDeadcodeDelay</a>()));</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  }</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;}</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01652"></a><span class="lineno"><a class="line" href="class_heritage.html#ad710084ce475a863e5d5d800300e3fd8"> 1652</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_heritage.html#ad710084ce475a863e5d5d800300e3fd8">Heritage::heritage</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;{</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  VarnodeLocSet::const_iterator iter,enditer;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <a class="code" href="class_addr_space.html">AddrSpace</a> *space;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <a class="code" href="class_heritage_info.html">HeritageInfo</a> *info;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  Varnode *vn;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  <span class="keywordtype">bool</span> needwarning;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  Varnode *warnvn = (Varnode *)0;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="keyword">const</span> <a class="code" href="class_addr_space_manager.html">AddrSpaceManager</a> *manage = fd-&gt;<a class="code" href="class_funcdata.html#a47b9d753da3c1caf025981ced51c1e96">getArch</a>();</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <a class="code" href="class_prefer_split_manager.html">PreferSplitManager</a> splitmanage;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="keywordflow">if</span> (maxdepth == -1)       <span class="comment">// Has a restructure been forced</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    buildADT();</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  processJoins();</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="keywordflow">if</span> (pass == 0) {</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    splitmanage.<a class="code" href="class_prefer_split_manager.html#a7b6c7e6e278991eacbf55cc6fe42ae30">init</a>(fd,&amp;fd-&gt;<a class="code" href="class_funcdata.html#a47b9d753da3c1caf025981ced51c1e96">getArch</a>()-&gt;<a class="code" href="class_architecture.html#a2ed25d7790e67e8bfaef34c092e5f39b">splitrecords</a>);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    splitmanage.<a class="code" href="class_prefer_split_manager.html#ac57104c8f58add45abec3119b2e89fee">split</a>();</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  }</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keywordflow">for</span>(int4 i=0;i&lt;manage-&gt;<a class="code" href="class_addr_space_manager.html#ae2d22102a7ce6080918e82daafabbdfa">numSpaces</a>();++i) {</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    space = manage-&gt;<a class="code" href="class_addr_space_manager.html#ad1a9a620e767ffe8bd929913f882e2a4">getSpace</a>(i);</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordflow">if</span> (!space-&gt;<a class="code" href="class_addr_space.html#a807313f845cda34701898ec89bad58cb">isHeritaged</a>()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    info = getInfo(space);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="keywordflow">if</span> (pass &lt; info-&gt;delay) <span class="keywordflow">continue</span>; <span class="comment">// It is too soon to heritage this space</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    needwarning = <span class="keyword">false</span>;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    iter = fd-&gt;<a class="code" href="class_funcdata.html#ac34a257742ad827bd278d0b35e15af74">beginLoc</a>(space);</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    enditer = fd-&gt;<a class="code" href="class_funcdata.html#a49f4e57094c47d431d81545f28172c1f">endLoc</a>(space);</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keywordflow">while</span>(iter != enditer) {</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      vn = *iter++;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <span class="keywordflow">if</span> ((!vn-&gt;isWritten())&amp;&amp;vn-&gt;hasNoDescend()&amp;&amp;(!vn-&gt;isUnaffected())&amp;&amp;(!vn-&gt;isInput()))</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keywordflow">if</span> (vn-&gt;isWriteMask()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      int4 prev = 0;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <a class="code" href="class_location_map.html#a13612b4d0583b85205f3ad6476c2aef9">LocationMap::iterator</a> liter = globaldisjoint.<a class="code" href="class_location_map.html#a72014909f852e240636856c3fec0ca04">add</a>(vn-&gt;getAddr(),vn-&gt;getSize(),pass,prev);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="keywordflow">if</span> (prev == 0)        <span class="comment">// All new location being heritaged, or intersecting with something new</span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    disjoint.<a class="code" href="class_location_map.html#a72014909f852e240636856c3fec0ca04">add</a>((*liter).first,(*liter).second.size,pass,prev);</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (prev==2) { <span class="comment">// If completely contained in range from previous pass</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordflow">if</span> (vn-&gt;isHeritageKnown()) <span class="keywordflow">continue</span>; <span class="comment">// Don&#39;t heritage if we don&#39;t have to </span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keywordflow">if</span> (vn-&gt;hasNoDescend()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keywordflow">if</span> ((!needwarning)&amp;&amp;(info-&gt;deadremoved&gt;0)) {</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      needwarning = <span class="keyword">true</span>;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      bumpDeadcodeDelay(vn);</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      warnvn = vn;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    }</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    disjoint.<a class="code" href="class_location_map.html#a72014909f852e240636856c3fec0ca04">add</a>((*liter).first,(*liter).second.size,pass,prev);</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      }</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordflow">if</span> ((!needwarning)&amp;&amp;(info-&gt;deadremoved&gt;0)) {</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <span class="comment">// TODO: We should check if this varnode is tiled by previously heritaged ranges</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="keywordflow">if</span> (vn-&gt;isHeritageKnown()) <span class="keywordflow">continue</span>;      <span class="comment">// Assume that it is tiled and produced by merging</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;          <span class="comment">// In most cases, a truly new overlapping read will hit the bumpDeadcodeDelay either here or in prev==2</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      needwarning = <span class="keyword">true</span>;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      bumpDeadcodeDelay(vn);</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      warnvn = vn;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    }</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    disjoint.<a class="code" href="class_location_map.html#a72014909f852e240636856c3fec0ca04">add</a>((*liter).first,(*liter).second.size,pass,prev);</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      }</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    }</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordflow">if</span> (needwarning) {</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      <span class="keywordflow">if</span> (!info-&gt;warningissued) {</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    info-&gt;warningissued = <span class="keyword">true</span>;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    ostringstream errmsg;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    errmsg &lt;&lt; <span class="stringliteral">&quot;Heritage AFTER dead removal. Example location: &quot;</span>;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    warnvn-&gt;printRawNoMarkup(errmsg);</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keywordflow">if</span> (!warnvn-&gt;hasNoDescend()) {</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      PcodeOp *warnop = *warnvn-&gt;beginDescend();</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      errmsg &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      warnop-&gt;getAddr().printRaw(errmsg);</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    }</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    fd-&gt;<a class="code" href="class_funcdata.html#a87967b12187406a7fdf311cc4b836118">warningHeader</a>(errmsg.str());</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      }</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    }</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  }</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <a class="code" href="class_heritage.html#acf14995e58b23df915ad06e9ff7f1165">placeMultiequals</a>();</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <a class="code" href="class_heritage.html#a68d25aa348dd9e8c5f13d708b2310772">rename</a>();</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="keywordflow">if</span> (pass == 0)</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    splitmanage.<a class="code" href="class_prefer_split_manager.html#a9b4943224f9764638eca4789f834913a">splitAdditional</a>();</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  pass += 1;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;}</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01741"></a><span class="lineno"><a class="line" href="class_heritage.html#ad5576d24243e351ea478fe5b1174370b"> 1741</a></span>&#160;int4 <a class="code" href="class_heritage.html#ad5576d24243e351ea478fe5b1174370b">Heritage::numHeritagePasses</a>(<a class="code" href="class_addr_space.html">AddrSpace</a> *spc)<span class="keyword"> const</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="keyword"></span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="keyword">const</span> <a class="code" href="class_heritage_info.html">HeritageInfo</a> *info = getInfo(spc);</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="keywordflow">if</span> (info == (<span class="keyword">const</span> <a class="code" href="class_heritage_info.html">HeritageInfo</a> *)0)</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Trying to calculate passes for non-heritaged space&quot;</span>);</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  <span class="keywordflow">return</span> (info-&gt;delay - pass);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;}</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div><div class="line"><a name="l01753"></a><span class="lineno"><a class="line" href="class_heritage.html#abbcd7a583bd605db1177b9c2e0be599f"> 1753</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_heritage.html#abbcd7a583bd605db1177b9c2e0be599f">Heritage::seenDeadCode</a>(<a class="code" href="class_addr_space.html">AddrSpace</a> *spc)</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;{</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <a class="code" href="class_heritage_info.html">HeritageInfo</a> *info = getInfo(spc);</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="keywordflow">if</span> (info == (<a class="code" href="class_heritage_info.html">HeritageInfo</a> *)0)</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Informed of deadcode removal for non-heritaged space&quot;</span>);</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  info-&gt;deadremoved = 1;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;}</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div><div class="line"><a name="l01767"></a><span class="lineno"><a class="line" href="class_heritage.html#a4f3d2a0674635a527b72ff6b96774f33"> 1767</a></span>&#160;int4 <a class="code" href="class_heritage.html#a4f3d2a0674635a527b72ff6b96774f33">Heritage::getDeadCodeDelay</a>(<a class="code" href="class_addr_space.html">AddrSpace</a> *spc)<span class="keyword"> const</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="keyword"></span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  <span class="keyword">const</span> <a class="code" href="class_heritage_info.html">HeritageInfo</a> *info = getInfo(spc);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <span class="keywordflow">if</span> (info == (<span class="keyword">const</span> <a class="code" href="class_heritage_info.html">HeritageInfo</a> *)0)</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Could not get heritage delay for space: &quot;</span>+spc-&gt;<a class="code" href="class_addr_space.html#a0ff86055617ff65ee8961b7c4e6caf98">getName</a>());</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <span class="keywordflow">return</span> info-&gt;deadcodedelay;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;}</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div><div class="line"><a name="l01781"></a><span class="lineno"><a class="line" href="class_heritage.html#a8377c55d2b77f230779ad43e341e6a29"> 1781</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_heritage.html#a8377c55d2b77f230779ad43e341e6a29">Heritage::setDeadCodeDelay</a>(<a class="code" href="class_addr_space.html">AddrSpace</a> *spc,int4 delay)</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;{</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <a class="code" href="class_heritage_info.html">HeritageInfo</a> *info = getInfo(spc);</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="keywordflow">if</span> (info == (<a class="code" href="class_heritage_info.html">HeritageInfo</a> *)0)</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Setting heritage delay for non-heritaged space&quot;</span>);</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="keywordflow">if</span> (delay &lt; info-&gt;delay)</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Illegal deadcode delay setting&quot;</span>);</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  info-&gt;deadcodedelay = delay;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;}</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div><div class="line"><a name="l01797"></a><span class="lineno"><a class="line" href="class_heritage.html#a664720f99b5b26c63a5f0349f4a83a0c"> 1797</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_heritage.html#a664720f99b5b26c63a5f0349f4a83a0c">Heritage::deadRemovalAllowed</a>(<a class="code" href="class_addr_space.html">AddrSpace</a> *spc)<span class="keyword"> const</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="keyword"></span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <span class="keyword">const</span> <a class="code" href="class_heritage_info.html">HeritageInfo</a> *info = getInfo(spc);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="keywordflow">if</span> (info == (<a class="code" href="class_heritage_info.html">HeritageInfo</a> *)0)</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Heritage query for non-heritaged space&quot;</span>);</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="keywordflow">return</span> (pass &gt; info-&gt;deadcodedelay);</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;}</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div><div class="line"><a name="l01813"></a><span class="lineno"><a class="line" href="class_heritage.html#a2bbf92b2085d45de9f3920824a51786c"> 1813</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_heritage.html#a2bbf92b2085d45de9f3920824a51786c">Heritage::deadRemovalAllowedSeen</a>(<a class="code" href="class_addr_space.html">AddrSpace</a> *spc)</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;{</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <a class="code" href="class_heritage_info.html">HeritageInfo</a> *info = getInfo(spc);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keywordflow">if</span> (info == (<a class="code" href="class_heritage_info.html">HeritageInfo</a> *)0)</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="struct_lowlevel_error.html">LowlevelError</a>(<span class="stringliteral">&quot;Heritage query for non-heritaged space&quot;</span>);</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keywordtype">bool</span> res = (pass &gt; info-&gt;deadcodedelay);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="keywordflow">if</span> (res)</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    info-&gt;deadremoved = 1;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;}</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;</div><div class="line"><a name="l01827"></a><span class="lineno"><a class="line" href="class_heritage.html#a7cdea4058aa42f91bbdb5a9b3171950f"> 1827</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_heritage.html#a7cdea4058aa42f91bbdb5a9b3171950f">Heritage::clear</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;{</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  disjoint.<a class="code" href="class_location_map.html#a76bf666b4ad4b511cfd0290b9b04aa72">clear</a>();</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  globaldisjoint.<a class="code" href="class_location_map.html#a76bf666b4ad4b511cfd0290b9b04aa72">clear</a>();</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  domchild.clear();</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  augment.clear();</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  flags.clear();</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  depth.clear();</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  merge.clear();</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  clearInfoList();</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  maxdepth = -1;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  pass = 0;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;}</div><div class="ttc" id="class_heritage_html_ad5576d24243e351ea478fe5b1174370b"><div class="ttname"><a href="class_heritage.html#ad5576d24243e351ea478fe5b1174370b">Heritage::numHeritagePasses</a></div><div class="ttdeci">int4 numHeritagePasses(AddrSpace *spc) const</div><div class="ttdoc">Get the number times heritage was performed for the given address space.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01741">heritage.cc:1741</a></div></div>
<div class="ttc" id="class_func_call_specs_html"><div class="ttname"><a href="class_func_call_specs.html">FuncCallSpecs</a></div><div class="ttdoc">A class for analyzing parameters to a sub-function call.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l01328">fspec.hh:1328</a></div></div>
<div class="ttc" id="class_funcdata_html_a9dd86e17a47020d06ac8dfd3bb732fe5"><div class="ttname"><a href="class_funcdata.html#a9dd86e17a47020d06ac8dfd3bb732fe5">Funcdata::opInsertBefore</a></div><div class="ttdeci">void opInsertBefore(PcodeOp *op, PcodeOp *follow)</div><div class="ttdoc">Insert given PcodeOp before a specific op.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00318">funcdata_op.cc:318</a></div></div>
<div class="ttc" id="class_funcdata_html_ae6341eb8ca8a8004f1c77a8e8147a286"><div class="ttname"><a href="class_funcdata.html#ae6341eb8ca8a8004f1c77a8e8147a286">Funcdata::opInsertBegin</a></div><div class="ttdeci">void opInsertBegin(PcodeOp *op, BlockBasic *bl)</div><div class="ttdoc">Insert given PcodeOp at the beginning of a basic block.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00383">funcdata_op.cc:383</a></div></div>
<div class="ttc" id="opcodes_8hh_html_abeb7dfb0e9e2b3114e240a405d046ea7a69a387d1e0b510d027e69bdde8f03caa"><div class="ttname"><a href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a69a387d1e0b510d027e69bdde8f03caa">CPUI_PIECE</a></div><div class="ttdoc">Concatenate.</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8hh_source.html#l00114">opcodes.hh:114</a></div></div>
<div class="ttc" id="opcodes_8hh_html_abeb7dfb0e9e2b3114e240a405d046ea7aab409a4f8049204cbe5be65787497842"><div class="ttname"><a href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aab409a4f8049204cbe5be65787497842">CPUI_FLOAT_FLOAT2FLOAT</a></div><div class="ttdoc">Convert between different floating-point sizes.</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8hh_source.html#l00102">opcodes.hh:102</a></div></div>
<div class="ttc" id="class_addr_space_manager_html_ae2d22102a7ce6080918e82daafabbdfa"><div class="ttname"><a href="class_addr_space_manager.html#ae2d22102a7ce6080918e82daafabbdfa">AddrSpaceManager::numSpaces</a></div><div class="ttdeci">int4 numSpaces(void) const</div><div class="ttdoc">Get the number of address spaces for this processor.</div><div class="ttdef"><b>Definition:</b> <a href="translate_8hh_source.html#l00510">translate.hh:510</a></div></div>
<div class="ttc" id="class_effect_record_html_a9a77875d39274819c56d6e4df5f23ab0a02697f294ad0f4b53317da792c577a10"><div class="ttname"><a href="class_effect_record.html#a9a77875d39274819c56d6e4df5f23ab0a02697f294ad0f4b53317da792c577a10">EffectRecord::unknown_effect</a></div><div class="ttdoc">An unknown effect (indicates the absence of an EffectRecord)</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l00269">fspec.hh:269</a></div></div>
<div class="ttc" id="heritage_8hh_html"><div class="ttname"><a href="heritage_8hh.html">heritage.hh</a></div><div class="ttdoc">Utilities for building Static Single Assignment (SSA) form.</div></div>
<div class="ttc" id="class_priority_queue_html_a75ec253ec066ea6dc172f1f8bd88758b"><div class="ttname"><a href="class_priority_queue.html#a75ec253ec066ea6dc172f1f8bd88758b">PriorityQueue::reset</a></div><div class="ttdeci">void reset(int4 maxdepth)</div><div class="ttdoc">Reset to an empty queue.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l00097">heritage.cc:97</a></div></div>
<div class="ttc" id="class_priority_queue_html_a8abe49ecb70033726324497f4aafdb74"><div class="ttname"><a href="class_priority_queue.html#a8abe49ecb70033726324497f4aafdb74">PriorityQueue::insert</a></div><div class="ttdeci">void insert(FlowBlock *bl, int4 depth)</div><div class="ttdoc">Insert a block into the queue given its priority.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l00109">heritage.cc:109</a></div></div>
<div class="ttc" id="class_addr_space_manager_html"><div class="ttname"><a href="class_addr_space_manager.html">AddrSpaceManager</a></div><div class="ttdoc">A manager for different address spaces.</div><div class="ttdef"><b>Definition:</b> <a href="translate_8hh_source.html#l00212">translate.hh:212</a></div></div>
<div class="ttc" id="class_addr_space_html_ab548f4158529a29122d4d0a30d94ed98"><div class="ttname"><a href="class_addr_space.html#ab548f4158529a29122d4d0a30d94ed98">AddrSpace::getType</a></div><div class="ttdeci">spacetype getType(void) const</div><div class="ttdoc">Get the type of space.</div><div class="ttdef"><b>Definition:</b> <a href="space_8hh_source.html#l00270">space.hh:270</a></div></div>
<div class="ttc" id="class_funcdata_html_ae12a353a87a208c1a39442571990fb9f"><div class="ttname"><a href="class_funcdata.html#ae12a353a87a208c1a39442571990fb9f">Funcdata::newIndirectOp</a></div><div class="ttdeci">PcodeOp * newIndirectOp(PcodeOp *indeffect, const Address &amp;addr, int4 size)</div><div class="ttdoc">Find a representative CPUI_RETURN op for this function.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00612">funcdata_op.cc:612</a></div></div>
<div class="ttc" id="class_varnode_html_ad367c0ac3c08b6f41e7334e90a138e8ca7d4bde53093050741edab33ff1b80b0a"><div class="ttname"><a href="class_varnode.html#ad367c0ac3c08b6f41e7334e90a138e8ca7d4bde53093050741edab33ff1b80b0a">Varnode::addrtied</a></div><div class="ttdoc">High-level variable is tied to address.</div><div class="ttdef"><b>Definition:</b> <a href="varnode_8hh_source.html#l00091">varnode.hh:91</a></div></div>
<div class="ttc" id="class_func_call_specs_html_ad88ee3058ece9a8b19f4e25566c03121"><div class="ttname"><a href="class_func_call_specs.html#ad88ee3058ece9a8b19f4e25566c03121">FuncCallSpecs::getOp</a></div><div class="ttdeci">PcodeOp * getOp(void) const</div><div class="ttdoc">Get the CALL or CALLIND corresponding to this.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l01358">fspec.hh:1358</a></div></div>
<div class="ttc" id="class_funcdata_html_a0901453d881b28305cb071a3cc8a7fe9"><div class="ttname"><a href="class_funcdata.html#a0901453d881b28305cb071a3cc8a7fe9">Funcdata::numCalls</a></div><div class="ttdeci">int4 numCalls(void) const</div><div class="ttdoc">Get the number of calls made by this function.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00236">funcdata.hh:236</a></div></div>
<div class="ttc" id="class_addr_space_html_a63b510a07fd8450dc432d7e671f79f66"><div class="ttname"><a href="class_addr_space.html#a63b510a07fd8450dc432d7e671f79f66">AddrSpace::getDelay</a></div><div class="ttdeci">int4 getDelay(void) const</div><div class="ttdoc">Get number of heritage passes being delayed.</div><div class="ttdef"><b>Definition:</b> <a href="space_8hh_source.html#l00281">space.hh:281</a></div></div>
<div class="ttc" id="struct_varnode_data_html_a50d39ae46d51c8854b962f3ec4ee4e25"><div class="ttname"><a href="struct_varnode_data.html#a50d39ae46d51c8854b962f3ec4ee4e25">VarnodeData::size</a></div><div class="ttdeci">uint4 size</div><div class="ttdoc">The number of bytes in the location.</div><div class="ttdef"><b>Definition:</b> <a href="pcoderaw_8hh_source.html#l00036">pcoderaw.hh:36</a></div></div>
<div class="ttc" id="class_join_record_html_a18d9eb13c87a49511865fab244aa69f5"><div class="ttname"><a href="class_join_record.html#a18d9eb13c87a49511865fab244aa69f5">JoinRecord::numPieces</a></div><div class="ttdeci">int4 numPieces(void) const</div><div class="ttdoc">Get number of pieces in this record.</div><div class="ttdef"><b>Definition:</b> <a href="translate_8hh_source.html#l00195">translate.hh:195</a></div></div>
<div class="ttc" id="class_address_html_acd17db20230415cb1fe1ad33c34c11ff"><div class="ttname"><a href="class_address.html#acd17db20230415cb1fe1ad33c34c11ff">Address::getSpaceFromConst</a></div><div class="ttdeci">static AddrSpace * getSpaceFromConst(const Address &amp;addr)</div><div class="ttdoc">Recover an encoded address space from an address.</div><div class="ttdef"><b>Definition:</b> <a href="address_8hh_source.html#l00450">address.hh:450</a></div></div>
<div class="ttc" id="class_priority_queue_html_a6cd7194cc2cb973f33158a1d7dc7acc9"><div class="ttname"><a href="class_priority_queue.html#a6cd7194cc2cb973f33158a1d7dc7acc9">PriorityQueue::extract</a></div><div class="ttdeci">FlowBlock * extract(void)</div><div class="ttdoc">Retrieve the highest priority block.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l00121">heritage.cc:121</a></div></div>
<div class="ttc" id="class_func_call_specs_html_a4145c5e63b80ece45a2a4f0fd5949138"><div class="ttname"><a href="class_func_call_specs.html#a4145c5e63b80ece45a2a4f0fd5949138">FuncCallSpecs::isInputActive</a></div><div class="ttdeci">bool isInputActive(void) const</div><div class="ttdoc">Return true if input parameter recovery analysis is active.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l01380">fspec.hh:1380</a></div></div>
<div class="ttc" id="class_location_map_html_a76bf666b4ad4b511cfd0290b9b04aa72"><div class="ttname"><a href="class_location_map.html#a76bf666b4ad4b511cfd0290b9b04aa72">LocationMap::clear</a></div><div class="ttdeci">void clear(void)</div><div class="ttdoc">Clear the map of heritaged ranges.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8hh_source.html#l00055">heritage.hh:55</a></div></div>
<div class="ttc" id="class_funcdata_html_a4a711cda20fb99632665753918c03a65"><div class="ttname"><a href="class_funcdata.html#a4a711cda20fb99632665753918c03a65">Funcdata::getActiveOutput</a></div><div class="ttdeci">ParamActive * getActiveOutput(void) const</div><div class="ttdoc">Get the return prototype recovery object.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00367">funcdata.hh:367</a></div></div>
<div class="ttc" id="class_funcdata_html_add1098b768d9a176cf59e4f4c9e27cb5"><div class="ttname"><a href="class_funcdata.html#add1098b768d9a176cf59e4f4c9e27cb5">Funcdata::newIndirectCreation</a></div><div class="ttdeci">PcodeOp * newIndirectCreation(PcodeOp *indeffect, const Address &amp;addr, int4 size, bool possibleout)</div><div class="ttdoc">Build a CPUI_INDIRECT op that indirectly creates a Varnode.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00663">funcdata_op.cc:663</a></div></div>
<div class="ttc" id="class_effect_record_html_a9a77875d39274819c56d6e4df5f23ab0a3488da6d6b149499cbe384f7b57d0564"><div class="ttname"><a href="class_effect_record.html#a9a77875d39274819c56d6e4df5f23ab0a3488da6d6b149499cbe384f7b57d0564">EffectRecord::unaffected</a></div><div class="ttdoc">The sub-function does not change the value at all.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l00266">fspec.hh:266</a></div></div>
<div class="ttc" id="class_flow_block_html_aa09d7d958c190fa86a30dbe9ac23c78f"><div class="ttname"><a href="class_flow_block.html#aa09d7d958c190fa86a30dbe9ac23c78f">FlowBlock::getParent</a></div><div class="ttdeci">FlowBlock * getParent(void)</div><div class="ttdoc">Get the parent FlowBlock of this.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00148">block.hh:148</a></div></div>
<div class="ttc" id="class_funcdata_html_a1b1961c6d9c58e9a0a20f74c6e49853f"><div class="ttname"><a href="class_funcdata.html#a1b1961c6d9c58e9a0a20f74c6e49853f">Funcdata::getFuncProto</a></div><div class="ttdeci">FuncProto &amp; getFuncProto(void)</div><div class="ttdoc">Get the function's prototype object.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00359">funcdata.hh:359</a></div></div>
<div class="ttc" id="class_prefer_split_manager_html_a9b4943224f9764638eca4789f834913a"><div class="ttname"><a href="class_prefer_split_manager.html#a9b4943224f9764638eca4789f834913a">PreferSplitManager::splitAdditional</a></div><div class="ttdeci">void splitAdditional(void)</div><div class="ttdef"><b>Definition:</b> <a href="prefersplit_8cc_source.html#l00562">prefersplit.cc:562</a></div></div>
<div class="ttc" id="class_heritage_html_a7cdea4058aa42f91bbdb5a9b3171950f"><div class="ttname"><a href="class_heritage.html#a7cdea4058aa42f91bbdb5a9b3171950f">Heritage::clear</a></div><div class="ttdeci">void clear(void)</div><div class="ttdoc">Reset all analysis of heritage.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01827">heritage.cc:1827</a></div></div>
<div class="ttc" id="class_flow_block_html"><div class="ttname"><a href="class_flow_block.html">FlowBlock</a></div><div class="ttdoc">Description of a control-flow block containing PcodeOps.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00060">block.hh:60</a></div></div>
<div class="ttc" id="class_block_graph_html_a12bc7480ffcc4c163a2a2cd800742f09"><div class="ttname"><a href="class_block_graph.html#a12bc7480ffcc4c163a2a2cd800742f09">BlockGraph::getSize</a></div><div class="ttdeci">int4 getSize(void) const</div><div class="ttdoc">Get the number of components.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00285">block.hh:285</a></div></div>
<div class="ttc" id="class_heritage_html_acf14995e58b23df915ad06e9ff7f1165"><div class="ttname"><a href="class_heritage.html#acf14995e58b23df915ad06e9ff7f1165">Heritage::placeMultiequals</a></div><div class="ttdeci">void placeMultiequals(void)</div><div class="ttdoc">Perform phi-node placement for the current set of address ranges.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01583">heritage.cc:1583</a></div></div>
<div class="ttc" id="class_funcdata_html_ac34a257742ad827bd278d0b35e15af74"><div class="ttname"><a href="class_funcdata.html#ac34a257742ad827bd278d0b35e15af74">Funcdata::beginLoc</a></div><div class="ttdeci">VarnodeLocSet::const_iterator beginLoc(void) const</div><div class="ttdoc">Start of all Varnodes sorted by storage.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00290">funcdata.hh:290</a></div></div>
<div class="ttc" id="class_func_proto_html_a65c37f6adddd70f3fd17500dcacd0c92"><div class="ttname"><a href="class_func_proto.html#a65c37f6adddd70f3fd17500dcacd0c92">FuncProto::possibleOutputParam</a></div><div class="ttdeci">bool possibleOutputParam(const Address &amp;addr, int4 size) const</div><div class="ttdoc">Decide whether a given storage location could be a return value.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8cc_source.html#l03282">fspec.cc:3282</a></div></div>
<div class="ttc" id="class_func_call_specs_html_a37a11cd8c631ed5b643eaf259b2ae49b"><div class="ttname"><a href="class_func_call_specs.html#a37a11cd8c631ed5b643eaf259b2ae49b">FuncCallSpecs::hasEffectTranslate</a></div><div class="ttdeci">uint4 hasEffectTranslate(const Address &amp;addr, int4 size) const</div><div class="ttdoc">Calculate type of side-effect for a given storage location (with caller translation)</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8cc_source.html#l04684">fspec.cc:4684</a></div></div>
<div class="ttc" id="class_func_call_specs_html_a32432a6c7b201dc160ae0b2480a1b8b9"><div class="ttname"><a href="class_func_call_specs.html#a32432a6c7b201dc160ae0b2480a1b8b9">FuncCallSpecs::getActiveInput</a></div><div class="ttdeci">ParamActive * getActiveInput(void)</div><div class="ttdoc">Get the analysis object for input parameter recovery.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l01384">fspec.hh:1384</a></div></div>
<div class="ttc" id="class_funcdata_html_a47b9d753da3c1caf025981ced51c1e96"><div class="ttname"><a href="class_funcdata.html#a47b9d753da3c1caf025981ced51c1e96">Funcdata::getArch</a></div><div class="ttdeci">Architecture * getArch(void) const</div><div class="ttdoc">Get the program/architecture owning the function.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00125">funcdata.hh:125</a></div></div>
<div class="ttc" id="opcodes_8hh_html_abeb7dfb0e9e2b3114e240a405d046ea7aa89e33b07a26ca7d26b54315e45c8424"><div class="ttname"><a href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7aa89e33b07a26ca7d26b54315e45c8424">CPUI_INDIRECT</a></div><div class="ttdoc">Copy with an indirect effect.</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8hh_source.html#l00113">opcodes.hh:113</a></div></div>
<div class="ttc" id="class_architecture_html_a9ec2e6c18d4b1280dc955ec0ace7d476"><div class="ttname"><a href="class_architecture.html#a9ec2e6c18d4b1280dc955ec0ace7d476">Architecture::highPtrPossible</a></div><div class="ttdeci">bool highPtrPossible(const Address &amp;loc, int4 size) const</div><div class="ttdoc">Are pointers possible to the given location?</div><div class="ttdef"><b>Definition:</b> <a href="architecture_8hh_source.html#l00297">architecture.hh:297</a></div></div>
<div class="ttc" id="types_8h_html_a2db313c5d32a12b01d26ac9b3bca178f"><div class="ttname"><a href="types_8h.html#a2db313c5d32a12b01d26ac9b3bca178f">uintb</a></div><div class="ttdeci">uint8 uintb</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00226">types.h:226</a></div></div>
<div class="ttc" id="heritage_8hh_html_a06c866be068de18f657eeea50b3790ba"><div class="ttname"><a href="heritage_8hh.html#a06c866be068de18f657eeea50b3790ba">VariableStack</a></div><div class="ttdeci">map&lt; Address, vector&lt; Varnode * &gt; &gt; VariableStack</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8hh_source.html#l00027">heritage.hh:27</a></div></div>
<div class="ttc" id="class_func_proto_html_a59ed6ca81a4b601ae81f4080a5bf89fa"><div class="ttname"><a href="class_func_proto.html#a59ed6ca81a4b601ae81f4080a5bf89fa">FuncProto::possibleInputParam</a></div><div class="ttdeci">bool possibleInputParam(const Address &amp;addr, int4 size) const</div><div class="ttdoc">Decide whether a given storage location could be an input parameter.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8cc_source.html#l03250">fspec.cc:3250</a></div></div>
<div class="ttc" id="class_funcdata_html_aab7f940f85609d395283520eca3a71f0"><div class="ttname"><a href="class_funcdata.html#aab7f940f85609d395283520eca3a71f0">Funcdata::totalReplace</a></div><div class="ttdeci">void totalReplace(Varnode *vn, Varnode *newvn)</div><div class="ttdoc">Replace all read references to the first Varnode with a second Varnode.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__varnode_8cc_source.html#l01024">funcdata_varnode.cc:1024</a></div></div>
<div class="ttc" id="opcodes_8hh_html_abeb7dfb0e9e2b3114e240a405d046ea7a108d223da48e77fa181637fc3e75d9e8"><div class="ttname"><a href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a108d223da48e77fa181637fc3e75d9e8">CPUI_MULTIEQUAL</a></div><div class="ttdoc">Phi-node operator.</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8hh_source.html#l00112">opcodes.hh:112</a></div></div>
<div class="ttc" id="class_location_map_html_ae639047ed4f014b5a05511a65e886398"><div class="ttname"><a href="class_location_map.html#ae639047ed4f014b5a05511a65e886398">LocationMap::begin</a></div><div class="ttdeci">iterator begin(void)</div><div class="ttdoc">Get starting iterator over heritaged ranges.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8hh_source.html#l00053">heritage.hh:53</a></div></div>
<div class="ttc" id="class_block_basic_html_a779d71352d86f6af4342b419713c03d5"><div class="ttname"><a href="class_block_basic.html#a779d71352d86f6af4342b419713c03d5">BlockBasic::getStart</a></div><div class="ttdeci">virtual Address getStart(void) const</div><div class="ttdoc">Get the starting address of code in this FlowBlock.</div><div class="ttdef"><b>Definition:</b> <a href="block_8cc_source.html#l02133">block.cc:2133</a></div></div>
<div class="ttc" id="class_heritage_html_abbcd7a583bd605db1177b9c2e0be599f"><div class="ttname"><a href="class_heritage.html#abbcd7a583bd605db1177b9c2e0be599f">Heritage::seenDeadCode</a></div><div class="ttdeci">void seenDeadCode(AddrSpace *spc)</div><div class="ttdoc">Inform system of dead code removal in given space.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01753">heritage.cc:1753</a></div></div>
<div class="ttc" id="class_varnode_html_ad367c0ac3c08b6f41e7334e90a138e8ca952005b91ba1b04e4d431eecb1309112"><div class="ttname"><a href="class_varnode.html#ad367c0ac3c08b6f41e7334e90a138e8ca952005b91ba1b04e4d431eecb1309112">Varnode::persist</a></div><div class="ttdoc">Persists after (and before) function.</div><div class="ttdef"><b>Definition:</b> <a href="varnode_8hh_source.html#l00090">varnode.hh:90</a></div></div>
<div class="ttc" id="class_funcdata_html_a1b1e9831bb4b1c65df6950ae1f15e0be"><div class="ttname"><a href="class_funcdata.html#a1b1e9831bb4b1c65df6950ae1f15e0be">Funcdata::newOp</a></div><div class="ttdeci">PcodeOp * newOp(int4 inputs, const Address &amp;pc)</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00295">funcdata_op.cc:295</a></div></div>
<div class="ttc" id="class_param_active_html_a43a357162f55b3b8f7e13a013ad207b5"><div class="ttname"><a href="class_param_active.html#a43a357162f55b3b8f7e13a013ad207b5">ParamActive::registerTrial</a></div><div class="ttdeci">void registerTrial(const Address &amp;addr, int4 sz)</div><div class="ttdoc">Add a new trial to the container.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8cc_source.html#l01263">fspec.cc:1263</a></div></div>
<div class="ttc" id="class_location_map_html_aa4e4c0f548533f8607a706cf7796c789"><div class="ttname"><a href="class_location_map.html#aa4e4c0f548533f8607a706cf7796c789">LocationMap::findPass</a></div><div class="ttdeci">int4 findPass(Address addr) const</div><div class="ttdoc">Look up if/how given address was heritaged.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l00083">heritage.cc:83</a></div></div>
<div class="ttc" id="class_flow_block_html_ab95b430d4c8470c379dba93613c3073b"><div class="ttname"><a href="class_flow_block.html#ab95b430d4c8470c379dba93613c3073b">FlowBlock::getOut</a></div><div class="ttdeci">FlowBlock * getOut(int4 i)</div><div class="ttdoc">Get the i-th output FlowBlock.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00208">block.hh:208</a></div></div>
<div class="ttc" id="opcodes_8hh_html_abeb7dfb0e9e2b3114e240a405d046ea7a50235a7bf50bada36dff73ff740c34d0"><div class="ttname"><a href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a50235a7bf50bada36dff73ff740c34d0">CPUI_CALL</a></div><div class="ttdoc">Call to an absolute address.</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8hh_source.html#l00044">opcodes.hh:44</a></div></div>
<div class="ttc" id="class_effect_record_html_a9a77875d39274819c56d6e4df5f23ab0afa04c6c617a1044c79c7bc9b7d661be2"><div class="ttname"><a href="class_effect_record.html#a9a77875d39274819c56d6e4df5f23ab0afa04c6c617a1044c79c7bc9b7d661be2">EffectRecord::return_address</a></div><div class="ttdoc">The memory is being used to pass back a return value from the sub-function.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l00268">fspec.hh:268</a></div></div>
<div class="ttc" id="class_funcdata_html_ab2bd3523c574c5b303728ef4d880ec3a"><div class="ttname"><a href="class_funcdata.html#ab2bd3523c574c5b303728ef4d880ec3a">Funcdata::opSetOutput</a></div><div class="ttdeci">void opSetOutput(PcodeOp *op, Varnode *vn)</div><div class="ttdoc">Set a specific output Varnode for the given PcodeOp.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00068">funcdata_op.cc:68</a></div></div>
<div class="ttc" id="space_8hh_html_a1a83535cca68b7ca3f25bfad70262231aebea73c9a75ffad2803a312d021932b5"><div class="ttname"><a href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231aebea73c9a75ffad2803a312d021932b5">IPTR_SPACEBASE</a></div><div class="ttdoc">addresses = offsets off of base register</div><div class="ttdef"><b>Definition:</b> <a href="space_8hh_source.html#l00031">space.hh:31</a></div></div>
<div class="ttc" id="opcodes_8hh_html_abeb7dfb0e9e2b3114e240a405d046ea7af2f97499d0b08f223110ad8f59353b44"><div class="ttname"><a href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7af2f97499d0b08f223110ad8f59353b44">CPUI_RETURN</a></div><div class="ttdoc">Return from subroutine.</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8hh_source.html#l00047">opcodes.hh:47</a></div></div>
<div class="ttc" id="class_block_graph_html_ac87b63ceb9f08a4f8667da43e25c7e5e"><div class="ttname"><a href="class_block_graph.html#ac87b63ceb9f08a4f8667da43e25c7e5e">BlockGraph::getBlock</a></div><div class="ttdeci">FlowBlock * getBlock(int4 i) const</div><div class="ttdoc">Get the i-th component.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00286">block.hh:286</a></div></div>
<div class="ttc" id="class_addr_space_manager_html_ad1a9a620e767ffe8bd929913f882e2a4"><div class="ttname"><a href="class_addr_space_manager.html#ad1a9a620e767ffe8bd929913f882e2a4">AddrSpaceManager::getSpace</a></div><div class="ttdeci">AddrSpace * getSpace(int4 i) const</div><div class="ttdoc">Get an address space via its index.</div><div class="ttdef"><b>Definition:</b> <a href="translate_8hh_source.html#l00519">translate.hh:519</a></div></div>
<div class="ttc" id="class_location_map_html_a46317268798a00ecc792e87a4a360bef"><div class="ttname"><a href="class_location_map.html#a46317268798a00ecc792e87a4a360bef">LocationMap::find</a></div><div class="ttdeci">iterator find(Address addr)</div><div class="ttdoc">Look up if/how given address was heritaged.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l00069">heritage.cc:69</a></div></div>
<div class="ttc" id="class_funcdata_html_a47de4c82b4a74b356153eb8e4215f639"><div class="ttname"><a href="class_funcdata.html#a47de4c82b4a74b356153eb8e4215f639">Funcdata::beginOp</a></div><div class="ttdeci">list&lt; PcodeOp * &gt;::const_iterator beginOp(OpCode opc) const</div><div class="ttdoc">Start of PcodeOp objects with the given op-code.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00422">funcdata.hh:422</a></div></div>
<div class="ttc" id="class_prefer_split_manager_html_ac57104c8f58add45abec3119b2e89fee"><div class="ttname"><a href="class_prefer_split_manager.html#ac57104c8f58add45abec3119b2e89fee">PreferSplitManager::split</a></div><div class="ttdeci">void split(void)</div><div class="ttdef"><b>Definition:</b> <a href="prefersplit_8cc_source.html#l00555">prefersplit.cc:555</a></div></div>
<div class="ttc" id="class_funcdata_html_af189a9a5b390332c6e87c8faa334cd68"><div class="ttname"><a href="class_funcdata.html#af189a9a5b390332c6e87c8faa334cd68">Funcdata::newUniqueOut</a></div><div class="ttdeci">Varnode * newUniqueOut(int4 s, PcodeOp *op)</div><div class="ttdoc">Create a new temporary output Varnode.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__varnode_8cc_source.html#l00126">funcdata_varnode.cc:126</a></div></div>
<div class="ttc" id="class_funcdata_html_ab34e641f5ee6f2ebf4aa708e21f2b24c"><div class="ttname"><a href="class_funcdata.html#ab34e641f5ee6f2ebf4aa708e21f2b24c">Funcdata::opInsertInput</a></div><div class="ttdeci">void opInsertInput(PcodeOp *op, Varnode *vn, int4 slot)</div><div class="ttdoc">Insert a new Varnode into the operand list for the given PcodeOp.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00281">funcdata_op.cc:281</a></div></div>
<div class="ttc" id="class_funcdata_html_a87967b12187406a7fdf311cc4b836118"><div class="ttname"><a href="class_funcdata.html#a87967b12187406a7fdf311cc4b836118">Funcdata::warningHeader</a></div><div class="ttdeci">void warningHeader(const string &amp;txt) const</div><div class="ttdoc">Add a warning comment as part of the function header.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8cc_source.html#l00111">funcdata.cc:111</a></div></div>
<div class="ttc" id="class_prefer_split_manager_html"><div class="ttname"><a href="class_prefer_split_manager.html">PreferSplitManager</a></div><div class="ttdef"><b>Definition:</b> <a href="prefersplit_8hh_source.html#l00029">prefersplit.hh:29</a></div></div>
<div class="ttc" id="funcdata_8hh_html"><div class="ttname"><a href="funcdata_8hh.html">funcdata.hh</a></div><div class="ttdoc">Utilities for processing data structures associated with a single function.</div></div>
<div class="ttc" id="class_override_html_a3845c19e46f983d2034e06bb1980b672"><div class="ttname"><a href="class_override.html#a3845c19e46f983d2034e06bb1980b672">Override::hasDeadcodeDelay</a></div><div class="ttdeci">bool hasDeadcodeDelay(AddrSpace *spc) const</div><div class="ttdoc">Check if a delay override is already installed for an address space.</div><div class="ttdef"><b>Definition:</b> <a href="override_8cc_source.html#l00082">override.cc:82</a></div></div>
<div class="ttc" id="class_addr_space_html"><div class="ttname"><a href="class_addr_space.html">AddrSpace</a></div><div class="ttdoc">A region where processor data is stored.</div><div class="ttdef"><b>Definition:</b> <a href="space_8hh_source.html#l00073">space.hh:73</a></div></div>
<div class="ttc" id="class_flow_block_html_a7ebfd2366874120b2d582313386cc28f"><div class="ttname"><a href="class_flow_block.html#a7ebfd2366874120b2d582313386cc28f">FlowBlock::getOutRevIndex</a></div><div class="ttdeci">int4 getOutRevIndex(int4 i) const</div><div class="ttdoc">Get the input index of the i-th output FlowBlock.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00210">block.hh:210</a></div></div>
<div class="ttc" id="class_funcdata_html_a8bc1d922d37c04236c4f7db44930b4fc"><div class="ttname"><a href="class_funcdata.html#a8bc1d922d37c04236c4f7db44930b4fc">Funcdata::getCallSpecs</a></div><div class="ttdeci">FuncCallSpecs * getCallSpecs(int4 i) const</div><div class="ttdoc">Get the i-th call specification.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00237">funcdata.hh:237</a></div></div>
<div class="ttc" id="opcodes_8hh_html_abeb7dfb0e9e2b3114e240a405d046ea7a36a10374a26740a58b5625f340f6ffad"><div class="ttname"><a href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a36a10374a26740a58b5625f340f6ffad">CPUI_COPY</a></div><div class="ttdoc">Copy one operand to another.</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8hh_source.html#l00036">opcodes.hh:36</a></div></div>
<div class="ttc" id="class_heritage_html_ad710084ce475a863e5d5d800300e3fd8"><div class="ttname"><a href="class_heritage.html#ad710084ce475a863e5d5d800300e3fd8">Heritage::heritage</a></div><div class="ttdeci">void heritage(void)</div><div class="ttdoc">Perform one pass of heritage.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01652">heritage.cc:1652</a></div></div>
<div class="ttc" id="class_funcdata_html_ac48d087ed5fbf901cfa608d8f44b6d5c"><div class="ttname"><a href="class_funcdata.html#ac48d087ed5fbf901cfa608d8f44b6d5c">Funcdata::getOverride</a></div><div class="ttdeci">Override &amp; getOverride(void)</div><div class="ttdoc">Get the Override object for this function.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00177">funcdata.hh:177</a></div></div>
<div class="ttc" id="class_heritage_html_a2bbf92b2085d45de9f3920824a51786c"><div class="ttname"><a href="class_heritage.html#a2bbf92b2085d45de9f3920824a51786c">Heritage::deadRemovalAllowedSeen</a></div><div class="ttdeci">bool deadRemovalAllowedSeen(AddrSpace *spc)</div><div class="ttdoc">Check if dead code removal is safe and mark that removal has happened.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01813">heritage.cc:1813</a></div></div>
<div class="ttc" id="class_funcdata_html"><div class="ttname"><a href="class_funcdata.html">Funcdata</a></div><div class="ttdoc">Container for data structures associated with a single function.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00045">funcdata.hh:45</a></div></div>
<div class="ttc" id="opcodes_8hh_html_abeb7dfb0e9e2b3114e240a405d046ea7a500b63ecb17a75652c705bfab98bc8e5"><div class="ttname"><a href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a500b63ecb17a75652c705bfab98bc8e5">CPUI_CALLIND</a></div><div class="ttdoc">Call through an indirect address.</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8hh_source.html#l00045">opcodes.hh:45</a></div></div>
<div class="ttc" id="class_param_active_html"><div class="ttname"><a href="class_param_active.html">ParamActive</a></div><div class="ttdoc">Container class for ParamTrial objects.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l00181">fspec.hh:181</a></div></div>
<div class="ttc" id="struct_varnode_data_html"><div class="ttname"><a href="struct_varnode_data.html">VarnodeData</a></div><div class="ttdoc">Data defining a specific memory location.</div><div class="ttdef"><b>Definition:</b> <a href="pcoderaw_8hh_source.html#l00033">pcoderaw.hh:33</a></div></div>
<div class="ttc" id="class_flow_block_html_aab379442c099264f10c1f1f3b9ecf5fe"><div class="ttname"><a href="class_flow_block.html#aab379442c099264f10c1f1f3b9ecf5fe">FlowBlock::sizeIn</a></div><div class="ttdeci">int4 sizeIn(void) const</div><div class="ttdoc">Get the number of in edges.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00218">block.hh:218</a></div></div>
<div class="ttc" id="class_funcdata_html_ad24461680d41c61349b3717283d8b854"><div class="ttname"><a href="class_funcdata.html#ad24461680d41c61349b3717283d8b854">Funcdata::endOp</a></div><div class="ttdeci">list&lt; PcodeOp * &gt;::const_iterator endOp(OpCode opc) const</div><div class="ttdoc">End of PcodeOp objects with the given op-code.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00425">funcdata.hh:425</a></div></div>
<div class="ttc" id="class_block_basic_html_abd3fc70635403ddb5c85c07b19c6f6b3"><div class="ttname"><a href="class_block_basic.html#abd3fc70635403ddb5c85c07b19c6f6b3">BlockBasic::endOp</a></div><div class="ttdeci">list&lt; PcodeOp * &gt;::iterator endOp(void)</div><div class="ttdoc">Return an iterator to the end of the PcodeOps.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00397">block.hh:397</a></div></div>
<div class="ttc" id="space_8hh_html_a1a83535cca68b7ca3f25bfad70262231ac6a759a590195b56c099150c63cdd7b2"><div class="ttname"><a href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231ac6a759a590195b56c099150c63cdd7b2">IPTR_PROCESSOR</a></div><div class="ttdoc">Normal spaces modelled by processor.</div><div class="ttdef"><b>Definition:</b> <a href="space_8hh_source.html#l00030">space.hh:30</a></div></div>
<div class="ttc" id="class_flow_block_html_a4b223b939cafc0405323dd0d6dc749d6"><div class="ttname"><a href="class_flow_block.html#a4b223b939cafc0405323dd0d6dc749d6">FlowBlock::getImmedDom</a></div><div class="ttdeci">FlowBlock * getImmedDom(void) const</div><div class="ttdoc">Get the immediate dominator FlowBlock.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00149">block.hh:149</a></div></div>
<div class="ttc" id="class_architecture_html_a2ed25d7790e67e8bfaef34c092e5f39b"><div class="ttname"><a href="class_architecture.html#a2ed25d7790e67e8bfaef34c092e5f39b">Architecture::splitrecords</a></div><div class="ttdeci">vector&lt; PreferSplitRecord &gt; splitrecords</div><div class="ttdoc">registers that we would prefer to see split for this processor</div><div class="ttdef"><b>Definition:</b> <a href="architecture_8hh_source.html#l00155">architecture.hh:155</a></div></div>
<div class="ttc" id="class_param_active_html_a94904915a57b3a27a68053e85d6d08e1"><div class="ttname"><a href="class_param_active.html#a94904915a57b3a27a68053e85d6d08e1">ParamActive::whichTrial</a></div><div class="ttdeci">int4 whichTrial(const Address &amp;addr, int4 sz) const</div><div class="ttdoc">Get the trial overlapping with the given memory range.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8cc_source.html#l01282">fspec.cc:1282</a></div></div>
<div class="ttc" id="class_flow_block_html_abf4424ddc9e448fcd52e72ebe9fb8a2b"><div class="ttname"><a href="class_flow_block.html#abf4424ddc9e448fcd52e72ebe9fb8a2b">FlowBlock::sizeOut</a></div><div class="ttdeci">int4 sizeOut(void) const</div><div class="ttdoc">Get the number of out edges.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00217">block.hh:217</a></div></div>
<div class="ttc" id="class_override_html_a2e55dd5f8157f3f7660c863eb7d036f9"><div class="ttname"><a href="class_override.html#a2e55dd5f8157f3f7660c863eb7d036f9">Override::insertDeadcodeDelay</a></div><div class="ttdeci">void insertDeadcodeDelay(AddrSpace *spc, int4 delay)</div><div class="ttdoc">Override the number of passes that are executed before dead-code elimination starts.</div><div class="ttdef"><b>Definition:</b> <a href="override_8cc_source.html#l00069">override.cc:69</a></div></div>
<div class="ttc" id="class_func_call_specs_html_a5f7aaec10dc1e68d73a07eaf4cac2542a584ec7401809588c22798803bff5b796"><div class="ttname"><a href="class_func_call_specs.html#a5f7aaec10dc1e68d73a07eaf4cac2542a584ec7401809588c22798803bff5b796">FuncCallSpecs::offset_unknown</a></div><div class="ttdoc">&quot;Magic&quot; stack offset indicating the offset is unknown</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l01354">fspec.hh:1354</a></div></div>
<div class="ttc" id="class_heritage_html_a8377c55d2b77f230779ad43e341e6a29"><div class="ttname"><a href="class_heritage.html#a8377c55d2b77f230779ad43e341e6a29">Heritage::setDeadCodeDelay</a></div><div class="ttdeci">void setDeadCodeDelay(AddrSpace *spc, int4 delay)</div><div class="ttdoc">Set delay for a specific space.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01781">heritage.cc:1781</a></div></div>
<div class="ttc" id="class_funcdata_html_aaa28789a086c52edd04c41e265818bbb"><div class="ttname"><a href="class_funcdata.html#aaa28789a086c52edd04c41e265818bbb">Funcdata::getScopeLocal</a></div><div class="ttdeci">ScopeLocal * getScopeLocal(void)</div><div class="ttdoc">Get the local function scope.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00357">funcdata.hh:357</a></div></div>
<div class="ttc" id="class_addr_space_html_a807313f845cda34701898ec89bad58cb"><div class="ttname"><a href="class_addr_space.html#a807313f845cda34701898ec89bad58cb">AddrSpace::isHeritaged</a></div><div class="ttdeci">bool isHeritaged(void) const</div><div class="ttdoc">Return true if dataflow has been traced.</div><div class="ttdef"><b>Definition:</b> <a href="space_8hh_source.html#l00353">space.hh:353</a></div></div>
<div class="ttc" id="class_func_call_specs_html_ad8990f080a96809b347656d7331236c5"><div class="ttname"><a href="class_func_call_specs.html#ad8990f080a96809b347656d7331236c5">FuncCallSpecs::getSpacebaseOffset</a></div><div class="ttdeci">uintb getSpacebaseOffset(void) const</div><div class="ttdoc">Get the stack-pointer relative offset at the point of this call site.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l01366">fspec.hh:1366</a></div></div>
<div class="ttc" id="class_addr_space_manager_html_addc2a210ade7c84962711a962e27dc32"><div class="ttname"><a href="class_addr_space_manager.html#addc2a210ade7c84962711a962e27dc32">AddrSpaceManager::getJoinSpace</a></div><div class="ttdeci">AddrSpace * getJoinSpace(void) const</div><div class="ttdoc">Get the joining space.</div><div class="ttdef"><b>Definition:</b> <a href="translate_8hh_source.html#l00444">translate.hh:444</a></div></div>
<div class="ttc" id="class_funcdata_html_a49f4e57094c47d431d81545f28172c1f"><div class="ttname"><a href="class_funcdata.html#a49f4e57094c47d431d81545f28172c1f">Funcdata::endLoc</a></div><div class="ttdeci">VarnodeLocSet::const_iterator endLoc(void) const</div><div class="ttdoc">End of all Varnodes sorted by storage.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00293">funcdata.hh:293</a></div></div>
<div class="ttc" id="opcodes_8hh_html_abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366"><div class="ttname"><a href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a></div><div class="ttdoc">Truncate.</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8hh_source.html#l00115">opcodes.hh:115</a></div></div>
<div class="ttc" id="class_addr_space_html_aaf923ed847e9804b55ffa12a51202712"><div class="ttname"><a href="class_addr_space.html#aaf923ed847e9804b55ffa12a51202712">AddrSpace::wrapOffset</a></div><div class="ttdeci">uintb wrapOffset(uintb off) const</div><div class="ttdoc">Wrap -off- to the offset that fits into this space.</div><div class="ttdef"><b>Definition:</b> <a href="space_8hh_source.html#l00329">space.hh:329</a></div></div>
<div class="ttc" id="struct_lowlevel_error_html"><div class="ttname"><a href="struct_lowlevel_error.html">LowlevelError</a></div><div class="ttdoc">The lowest level error generated by the decompiler.</div><div class="ttdef"><b>Definition:</b> <a href="error_8hh_source.html#l00044">error.hh:44</a></div></div>
<div class="ttc" id="struct_varnode_data_html_a1a69a5187f7a6376c0c93c08962ea68d"><div class="ttname"><a href="struct_varnode_data.html#a1a69a5187f7a6376c0c93c08962ea68d">VarnodeData::space</a></div><div class="ttdeci">AddrSpace * space</div><div class="ttdoc">The address space.</div><div class="ttdef"><b>Definition:</b> <a href="pcoderaw_8hh_source.html#l00034">pcoderaw.hh:34</a></div></div>
<div class="ttc" id="prefersplit_8hh_html"><div class="ttname"><a href="prefersplit_8hh.html">prefersplit.hh</a></div></div>
<div class="ttc" id="class_func_call_specs_html_ad3c3231b5c523e491d65f31ddb688cc1"><div class="ttname"><a href="class_func_call_specs.html#ad3c3231b5c523e491d65f31ddb688cc1">FuncCallSpecs::abortSpacebaseRelative</a></div><div class="ttdeci">void abortSpacebaseRelative(Funcdata &amp;data)</div><div class="ttdoc">Abort the attempt to recover the relative stack offset for this function.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8cc_source.html#l03758">fspec.cc:3758</a></div></div>
<div class="ttc" id="class_funcdata_html_ae3357db0b73196679a798903f28cd798"><div class="ttname"><a href="class_funcdata.html#ae3357db0b73196679a798903f28cd798">Funcdata::getAddress</a></div><div class="ttdeci">const Address &amp; getAddress(void) const</div><div class="ttdoc">Get the entry point address.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00123">funcdata.hh:123</a></div></div>
<div class="ttc" id="class_pcode_op_html_a41be82b850ff5185e51268aead2c2802"><div class="ttname"><a href="class_pcode_op.html#a41be82b850ff5185e51268aead2c2802">PcodeOp::getOpFromConst</a></div><div class="ttdeci">static PcodeOp * getOpFromConst(const Address &amp;addr)</div><div class="ttdoc">Retrieve the PcodeOp encoded as the address addr.</div><div class="ttdef"><b>Definition:</b> <a href="op_8hh_source.html#l00220">op.hh:220</a></div></div>
<div class="ttc" id="class_funcdata_html_af58542dbcc89f4b84ffc8834b023125b"><div class="ttname"><a href="class_funcdata.html#af58542dbcc89f4b84ffc8834b023125b">Funcdata::newConstant</a></div><div class="ttdeci">Varnode * newConstant(int4 s, uintb constant_val)</div><div class="ttdoc">Create a new constant Varnode.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__varnode_8cc_source.html#l00066">funcdata_varnode.cc:66</a></div></div>
<div class="ttc" id="class_addr_space_html_a51295f26c99891cb310af0eb0c20d4db"><div class="ttname"><a href="class_addr_space.html#a51295f26c99891cb310af0eb0c20d4db">AddrSpace::getDeadcodeDelay</a></div><div class="ttdeci">int4 getDeadcodeDelay(void) const</div><div class="ttdoc">Get number of passes before deadcode removal is allowed.</div><div class="ttdef"><b>Definition:</b> <a href="space_8hh_source.html#l00291">space.hh:291</a></div></div>
<div class="ttc" id="class_addr_space_html_a0ff86055617ff65ee8961b7c4e6caf98"><div class="ttname"><a href="class_addr_space.html#a0ff86055617ff65ee8961b7c4e6caf98">AddrSpace::getName</a></div><div class="ttdeci">const string &amp; getName(void) const</div><div class="ttdoc">Get the name.</div><div class="ttdef"><b>Definition:</b> <a href="space_8hh_source.html#l00243">space.hh:243</a></div></div>
<div class="ttc" id="opcodes_8hh_html_abeb7dfb0e9e2b3114e240a405d046ea7a14ab8d826af51873faa33b33e2bbc5fb"><div class="ttname"><a href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a14ab8d826af51873faa33b33e2bbc5fb">CPUI_STORE</a></div><div class="ttdoc">Store at a pointer into a specified address space.</div><div class="ttdef"><b>Definition:</b> <a href="opcodes_8hh_source.html#l00038">opcodes.hh:38</a></div></div>
<div class="ttc" id="class_funcdata_html_a22894e1c7b0f30a5391993924cd96d3d"><div class="ttname"><a href="class_funcdata.html#a22894e1c7b0f30a5391993924cd96d3d">Funcdata::newVarnode</a></div><div class="ttdeci">Varnode * newVarnode(int4 s, const Address &amp;m, Datatype *ct=(Datatype *) 0)</div><div class="ttdoc">Create a new unattached Varnode object.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__varnode_8cc_source.html#l00143">funcdata_varnode.cc:143</a></div></div>
<div class="ttc" id="class_location_map_html_a50624e32845eeea2cc26a7379c57111d"><div class="ttname"><a href="class_location_map.html#a50624e32845eeea2cc26a7379c57111d">LocationMap::erase</a></div><div class="ttdeci">void erase(iterator iter)</div><div class="ttdoc">Remove a particular entry from the map.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8hh_source.html#l00052">heritage.hh:52</a></div></div>
<div class="ttc" id="class_funcdata_html_aa8657c4c04279316593adc6d2f389be5"><div class="ttname"><a href="class_funcdata.html#aa8657c4c04279316593adc6d2f389be5">Funcdata::deleteVarnode</a></div><div class="ttdeci">void deleteVarnode(Varnode *vn)</div><div class="ttdoc">Delete the given varnode.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00256">funcdata.hh:256</a></div></div>
<div class="ttc" id="space_8hh_html_a1a83535cca68b7ca3f25bfad70262231a1eef2cfc279c246cc7ea0387d8c0aa66"><div class="ttname"><a href="space_8hh.html#a1a83535cca68b7ca3f25bfad70262231a1eef2cfc279c246cc7ea0387d8c0aa66">IPTR_INTERNAL</a></div><div class="ttdoc">Internally managed temporary space.</div><div class="ttdef"><b>Definition:</b> <a href="space_8hh_source.html#l00032">space.hh:32</a></div></div>
<div class="ttc" id="class_flow_block_html_a1830ec9a8397398dd1633cdd8ca56152"><div class="ttname"><a href="class_flow_block.html#a1830ec9a8397398dd1633cdd8ca56152">FlowBlock::getIndex</a></div><div class="ttdeci">int4 getIndex(void) const</div><div class="ttdoc">Get the index assigned to this block.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00147">block.hh:147</a></div></div>
<div class="ttc" id="class_func_call_specs_html_a866e9a9406614829224612035f28d311"><div class="ttname"><a href="class_func_call_specs.html#a866e9a9406614829224612035f28d311">FuncCallSpecs::getActiveOutput</a></div><div class="ttdeci">ParamActive * getActiveOutput(void)</div><div class="ttdoc">Get the analysis object for return value recovery.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l01385">fspec.hh:1385</a></div></div>
<div class="ttc" id="class_funcdata_html_add21153afa5eb571406d1f64b8b344db"><div class="ttname"><a href="class_funcdata.html#add21153afa5eb571406d1f64b8b344db">Funcdata::getBasicBlocks</a></div><div class="ttdeci">const BlockGraph &amp; getBasicBlocks(void) const</div><div class="ttdoc">Get the basic blocks container.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00463">funcdata.hh:463</a></div></div>
<div class="ttc" id="class_heritage_html_a68d25aa348dd9e8c5f13d708b2310772"><div class="ttname"><a href="class_heritage.html#a68d25aa348dd9e8c5f13d708b2310772">Heritage::rename</a></div><div class="ttdeci">void rename(void)</div><div class="ttdoc">Perform the renaming algorithm for the current set of address ranges.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01571">heritage.cc:1571</a></div></div>
<div class="ttc" id="class_funcdata_html_a6b77ee6442d79ae754d5dcf0b5318fca"><div class="ttname"><a href="class_funcdata.html#a6b77ee6442d79ae754d5dcf0b5318fca">Funcdata::opInsert</a></div><div class="ttdeci">void opInsert(PcodeOp *op, BlockBasic *bl, list&lt; PcodeOp * &gt;::iterator iter)</div><div class="ttdoc">Insert the given PcodeOp at specific point in a basic block.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00148">funcdata_op.cc:148</a></div></div>
<div class="ttc" id="class_funcdata_html_af21c852eb9f606c5cd19fb2456927ecd"><div class="ttname"><a href="class_funcdata.html#af21c852eb9f606c5cd19fb2456927ecd">Funcdata::setRestartPending</a></div><div class="ttdeci">void setRestartPending(bool val)</div><div class="ttdoc">Toggle whether analysis needs to be restarted for this function.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata_8hh_source.html#l00182">funcdata.hh:182</a></div></div>
<div class="ttc" id="class_heritage_info_html"><div class="ttname"><a href="class_heritage_info.html">HeritageInfo</a></div><div class="ttdoc">Information about heritage passes performed for a specific address space.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8hh_source.html#l00084">heritage.hh:84</a></div></div>
<div class="ttc" id="class_effect_record_html_a9a77875d39274819c56d6e4df5f23ab0aacd8991c4ebdeb4057e15faf1d08abc2"><div class="ttname"><a href="class_effect_record.html#a9a77875d39274819c56d6e4df5f23ab0aacd8991c4ebdeb4057e15faf1d08abc2">EffectRecord::killedbycall</a></div><div class="ttdoc">The memory is changed and is completely unrelated to its original value.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l00267">fspec.hh:267</a></div></div>
<div class="ttc" id="class_heritage_html_a4f3d2a0674635a527b72ff6b96774f33"><div class="ttname"><a href="class_heritage.html#a4f3d2a0674635a527b72ff6b96774f33">Heritage::getDeadCodeDelay</a></div><div class="ttdeci">int4 getDeadCodeDelay(AddrSpace *spc) const</div><div class="ttdoc">Get pass delay for heritaging the given space.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01767">heritage.cc:1767</a></div></div>
<div class="ttc" id="class_funcdata_html_a731f6fd415269577b7bb1943315b8a76"><div class="ttname"><a href="class_funcdata.html#a731f6fd415269577b7bb1943315b8a76">Funcdata::newUnique</a></div><div class="ttdeci">Varnode * newUnique(int4 s, Datatype *ct=(Datatype *) 0)</div><div class="ttdoc">Create a new temporary Varnode.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__varnode_8cc_source.html#l00083">funcdata_varnode.cc:83</a></div></div>
<div class="ttc" id="class_func_call_specs_html_a81e8386ebb901a273ef40d8e8430fb57"><div class="ttname"><a href="class_func_call_specs.html#a81e8386ebb901a273ef40d8e8430fb57">FuncCallSpecs::isOutputActive</a></div><div class="ttdeci">bool isOutputActive(void) const</div><div class="ttdoc">Return true if return value recovery analysis is active.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l01381">fspec.hh:1381</a></div></div>
<div class="ttc" id="class_priority_queue_html_aa52c8c07deead26f255cdbe92a0acd4e"><div class="ttname"><a href="class_priority_queue.html#aa52c8c07deead26f255cdbe92a0acd4e">PriorityQueue::empty</a></div><div class="ttdeci">bool empty(void) const</div><div class="ttdoc">Return true if this queue is empty.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8hh_source.html#l00072">heritage.hh:72</a></div></div>
<div class="ttc" id="class_block_basic_html"><div class="ttname"><a href="class_block_basic.html">BlockBasic</a></div><div class="ttdoc">A basic block for p-code operations.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00360">block.hh:360</a></div></div>
<div class="ttc" id="class_funcdata_html_a84a9880613a03f3aea65acf3dd1343d6"><div class="ttname"><a href="class_funcdata.html#a84a9880613a03f3aea65acf3dd1343d6">Funcdata::setInputVarnode</a></div><div class="ttdeci">Varnode * setInputVarnode(Varnode *vn)</div><div class="ttdoc">Mark a Varnode as an input to the function.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__varnode_8cc_source.html#l00326">funcdata_varnode.cc:326</a></div></div>
<div class="ttc" id="class_join_record_html_a71e39715b107db55fa5c737457877b3a"><div class="ttname"><a href="class_join_record.html#a71e39715b107db55fa5c737457877b3a">JoinRecord::getUnified</a></div><div class="ttdeci">const VarnodeData &amp; getUnified(void) const</div><div class="ttdoc">Get the Varnode whole.</div><div class="ttdef"><b>Definition:</b> <a href="translate_8hh_source.html#l00198">translate.hh:198</a></div></div>
<div class="ttc" id="class_block_basic_html_a3ddd779a5af8cb12e6fc069bd49ddb6c"><div class="ttname"><a href="class_block_basic.html#a3ddd779a5af8cb12e6fc069bd49ddb6c">BlockBasic::beginOp</a></div><div class="ttdeci">list&lt; PcodeOp * &gt;::iterator beginOp(void)</div><div class="ttdoc">Return an iterator to the beginning of the PcodeOps.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00396">block.hh:396</a></div></div>
<div class="ttc" id="class_addr_space_manager_html_adff0f9e662ebffdf724dca82b6b544bb"><div class="ttname"><a href="class_addr_space_manager.html#adff0f9e662ebffdf724dca82b6b544bb">AddrSpaceManager::findJoin</a></div><div class="ttdeci">JoinRecord * findJoin(uintb offset) const</div><div class="ttdoc">Find JoinRecord for offset in the join space.</div><div class="ttdef"><b>Definition:</b> <a href="translate_8cc_source.html#l00541">translate.cc:541</a></div></div>
<div class="ttc" id="class_funcdata_html_a3320ad92e11a48a06e21b8a55395a56b"><div class="ttname"><a href="class_funcdata.html#a3320ad92e11a48a06e21b8a55395a56b">Funcdata::opInsertAfter</a></div><div class="ttdeci">void opInsertAfter(PcodeOp *op, PcodeOp *prev)</div><div class="ttdoc">Insert given PcodeOp after a specific op.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00346">funcdata_op.cc:346</a></div></div>
<div class="ttc" id="struct_size_pass_html"><div class="ttname"><a href="struct_size_pass.html">SizePass</a></div><div class="ttdoc">Label for describing extent of address range that has been heritaged.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8hh_source.html#l00030">heritage.hh:30</a></div></div>
<div class="ttc" id="class_heritage_html_a9241f6a476085c88c540e34a44c5f197"><div class="ttname"><a href="class_heritage.html#a9241f6a476085c88c540e34a44c5f197">Heritage::Heritage</a></div><div class="ttdeci">Heritage(Funcdata *data)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l00135">heritage.cc:135</a></div></div>
<div class="ttc" id="class_funcdata_html_ad9dbf52668db4a1923537e2128719181"><div class="ttname"><a href="class_funcdata.html#ad9dbf52668db4a1923537e2128719181">Funcdata::opSetOpcode</a></div><div class="ttdeci">void opSetOpcode(PcodeOp *op, OpCode opc)</div><div class="ttdoc">Set the op-code for a specific PcodeOp.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00023">funcdata_op.cc:23</a></div></div>
<div class="ttc" id="class_join_record_html"><div class="ttname"><a href="class_join_record.html">JoinRecord</a></div><div class="ttdoc">A record describing how logical values are split.</div><div class="ttdef"><b>Definition:</b> <a href="translate_8hh_source.html#l00190">translate.hh:190</a></div></div>
<div class="ttc" id="class_location_map_html_a9d4bddedee005e780986d9752b93e4f0"><div class="ttname"><a href="class_location_map.html#a9d4bddedee005e780986d9752b93e4f0">LocationMap::end</a></div><div class="ttdeci">iterator end(void)</div><div class="ttdoc">Get ending iterator over heritaged ranges.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8hh_source.html#l00054">heritage.hh:54</a></div></div>
<div class="ttc" id="class_scope_html_a1b8c2c2302eba2666e319a4c18a67d51"><div class="ttname"><a href="class_scope.html#a1b8c2c2302eba2666e319a4c18a67d51">Scope::queryProperties</a></div><div class="ttdeci">SymbolEntry * queryProperties(const Address &amp;addr, int4 size, const Address &amp;usepoint, uint4 &amp;flags) const</div><div class="ttdoc">Find a Symbol or properties at the given address.</div><div class="ttdef"><b>Definition:</b> <a href="database_8cc_source.html#l01062">database.cc:1062</a></div></div>
<div class="ttc" id="class_funcdata_html_a100e6704e4c245e076170268d31b47ec"><div class="ttname"><a href="class_funcdata.html#a100e6704e4c245e076170268d31b47ec">Funcdata::newVarnodeOut</a></div><div class="ttdeci">Varnode * newVarnodeOut(int4 s, const Address &amp;m, PcodeOp *op)</div><div class="ttdoc">Create a new output Varnode.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__varnode_8cc_source.html#l00101">funcdata_varnode.cc:101</a></div></div>
<div class="ttc" id="class_flow_block_html_acbb1f895710c8339bd21d9c7a3200322"><div class="ttname"><a href="class_flow_block.html#acbb1f895710c8339bd21d9c7a3200322">FlowBlock::getIn</a></div><div class="ttdeci">FlowBlock * getIn(int4 i)</div><div class="ttdoc">Get the i-th input FlowBlock.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00211">block.hh:211</a></div></div>
<div class="ttc" id="class_funcdata_html_aa079e2bd26e92671be79601535236a63"><div class="ttname"><a href="class_funcdata.html#aa079e2bd26e92671be79601535236a63">Funcdata::opSetInput</a></div><div class="ttdeci">void opSetInput(PcodeOp *op, Varnode *vn, int4 slot)</div><div class="ttdoc">Set a specific input operand for the given PcodeOp.</div><div class="ttdef"><b>Definition:</b> <a href="funcdata__op_8cc_source.html#l00102">funcdata_op.cc:102</a></div></div>
<div class="ttc" id="class_heritage_html_a7cca3fa6fe1e5d6241ca3e0f0a29af42"><div class="ttname"><a href="class_heritage.html#a7cca3fa6fe1e5d6241ca3e0f0a29af42">Heritage::buildInfoList</a></div><div class="ttdeci">void buildInfoList(void)</div><div class="ttdoc">Initialize information for each space.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01637">heritage.cc:1637</a></div></div>
<div class="ttc" id="class_func_call_specs_html_abfda84c2a3919927503193ce9595efd6"><div class="ttname"><a href="class_func_call_specs.html#abfda84c2a3919927503193ce9595efd6">FuncCallSpecs::getStackPlaceholderSlot</a></div><div class="ttdeci">int4 getStackPlaceholderSlot(void) const</div><div class="ttdoc">Get the slot of the stack-pointer placeholder.</div><div class="ttdef"><b>Definition:</b> <a href="fspec_8hh_source.html#l01370">fspec.hh:1370</a></div></div>
<div class="ttc" id="class_heritage_html_a664720f99b5b26c63a5f0349f4a83a0c"><div class="ttname"><a href="class_heritage.html#a664720f99b5b26c63a5f0349f4a83a0c">Heritage::deadRemovalAllowed</a></div><div class="ttdeci">bool deadRemovalAllowed(AddrSpace *spc) const</div><div class="ttdoc">Return true if it is safe to remove dead code.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l01797">heritage.cc:1797</a></div></div>
<div class="ttc" id="class_block_graph_html_ae4f8f8599ed5e3eb803536f1c9595f09"><div class="ttname"><a href="class_block_graph.html#ae4f8f8599ed5e3eb803536f1c9595f09">BlockGraph::getStartBlock</a></div><div class="ttdeci">FlowBlock * getStartBlock(void) const</div><div class="ttdoc">Get the entry point FlowBlock.</div><div class="ttdef"><b>Definition:</b> <a href="block_8cc_source.html#l01473">block.cc:1473</a></div></div>
<div class="ttc" id="class_location_map_html_a72014909f852e240636856c3fec0ca04"><div class="ttname"><a href="class_location_map.html#a72014909f852e240636856c3fec0ca04">LocationMap::add</a></div><div class="ttdeci">iterator add(Address addr, int4 size, int4 pass, int4 &amp;intersect)</div><div class="ttdoc">Mark new address as heritaged.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8cc_source.html#l00030">heritage.cc:30</a></div></div>
<div class="ttc" id="class_join_record_html_a5d3feebaadef123349cda1564717b9d7"><div class="ttname"><a href="class_join_record.html#a5d3feebaadef123349cda1564717b9d7">JoinRecord::getPiece</a></div><div class="ttdeci">const VarnodeData &amp; getPiece(int4 i) const</div><div class="ttdoc">Get the i-th piece.</div><div class="ttdef"><b>Definition:</b> <a href="translate_8hh_source.html#l00197">translate.hh:197</a></div></div>
<div class="ttc" id="class_block_graph_html"><div class="ttname"><a href="class_block_graph.html">BlockGraph</a></div><div class="ttdoc">A control-flow block built out of sub-components.</div><div class="ttdef"><b>Definition:</b> <a href="block_8hh_source.html#l00267">block.hh:267</a></div></div>
<div class="ttc" id="class_prefer_split_manager_html_a7b6c7e6e278991eacbf55cc6fe42ae30"><div class="ttname"><a href="class_prefer_split_manager.html#a7b6c7e6e278991eacbf55cc6fe42ae30">PreferSplitManager::init</a></div><div class="ttdeci">void init(Funcdata *fd, const vector&lt; PreferSplitRecord &gt; *rec)</div><div class="ttdef"><b>Definition:</b> <a href="prefersplit_8cc_source.html#l00526">prefersplit.cc:526</a></div></div>
<div class="ttc" id="class_location_map_html_a13612b4d0583b85205f3ad6476c2aef9"><div class="ttname"><a href="class_location_map.html#a13612b4d0583b85205f3ad6476c2aef9">LocationMap::iterator</a></div><div class="ttdeci">map&lt; Address, SizePass &gt;::iterator iterator</div><div class="ttdoc">Iterator into the main map.</div><div class="ttdef"><b>Definition:</b> <a href="heritage_8hh_source.html#l00045">heritage.hh:45</a></div></div>
<div class="ttc" id="struct_varnode_data_html_a1a511384ee72e847b51423cc99c8233e"><div class="ttname"><a href="struct_varnode_data.html#a1a511384ee72e847b51423cc99c8233e">VarnodeData::offset</a></div><div class="ttdeci">uintb offset</div><div class="ttdoc">The offset within the space.</div><div class="ttdef"><b>Definition:</b> <a href="pcoderaw_8hh_source.html#l00035">pcoderaw.hh:35</a></div></div>
<div class="ttc" id="class_join_record_html_a0a9314d1dd21efb75d8851aa05c387c4"><div class="ttname"><a href="class_join_record.html#a0a9314d1dd21efb75d8851aa05c387c4">JoinRecord::isFloatExtension</a></div><div class="ttdeci">bool isFloatExtension(void) const</div><div class="ttdoc">Does this record extend a float varnode.</div><div class="ttdef"><b>Definition:</b> <a href="translate_8hh_source.html#l00196">translate.hh:196</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
